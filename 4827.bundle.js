(()=>{"use strict";var e,r,t={7208:(e,r,t)=>{var i,n=t(1309);const o={timeout:2e4,maxPageSize:4096,cacheSize:1024,headers:{}};var s;!function(e){e[e.WORKMSG=16777215]="WORKMSG",e[e.HANDSHAKE=16777214]="HANDSHAKE"}(s=s||(s={}));const a="undefined"!=typeof SQLITE_DEBUG&&SQLITE_DEBUG||void 0!==(null===(i=void 0==={env:{RLAYERS_DEBUG:void 0}}?void 0:{RLAYERS_DEBUG:void 0})||void 0===i?void 0:i.SQLITE_DEBUG)&&{RLAYERS_DEBUG:void 0}.SQLITE_DEBUG||"",c=["threads","vfs","cache","http"],d={};for(const e of c)d[e]=a.includes(e)?console.debug.bind(console):()=>{};const l=function(){const e=new ArrayBuffer(2),r=new Uint8Array(e),t=new Uint16Array(e);if(r[0]=240,r[1]=13,61453==t[0])return d.threads("System is Big-Endian"),!1;if(3568==t[0])return d.threads("System is Little-Endian"),!0;throw new Error(`Failed determining endianness: ${t}`)}();var u=function(e,r,t,i){return new(t||(t=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(s,a)}c((i=i.apply(e,r||[])).next())}))};let f;const h={},g=new n.A({max:32});let v,p=1;const m={xOpen:function(e){return u(this,void 0,void 0,(function*(){let r=g.get(e.url);return r instanceof Promise&&(r=yield r),void 0!==r||(r=fetch(e.url,{method:"HEAD",headers:Object.assign({},null==f?void 0:f.headers)}).then((r=>{var t;return"bytes"!==r.headers.get("Accept-Ranges")&&console.warn(`Server for ${e.url} does not advertise 'Accept-Ranges'. If the server supports it, in order to remove this message, add "Accept-Ranges: bytes". Additionally, if using CORS, add "Access-Control-Expose-Headers: *".`),{url:e.url,id:p++,size:BigInt(null!==(t=r.headers.get("Content-Length"))&&void 0!==t?t:0),pageSize:null}})),g.set(e.url,r),g.set(e.url,yield r)),0}))},xAccess:function(e,r){return u(this,void 0,void 0,(function*(){const t=new Uint32Array(r.shm,0,1);try{const i=yield m.xOpen(e,r);t[0]=0===i?1:0}catch(e){t[0]=0}return 0}))},xRead:function(e,r){var t,i,n;return u(this,void 0,void 0,(function*(){let s=g.get(e.url);if(!s)throw new Error(`File ${e.url} not open`);if(s instanceof Promise&&(s=yield s),void 0===e.n||void 0===e.offset)throw new Error("Mandatory arguments missing");if(!s.pageSize){s.pageSize=1024;const r=new ArrayBuffer(2),n=yield m.xRead({msg:"xRead",url:e.url,offset:BigInt(16),n:2},{buffer:new Uint8Array(r)}),a=new Uint16Array(r);if(0!==n)return n;if(function(e){if(l)for(let r=0;r<e.length;r++)e[r]=(65280&e[r])>>8|(255&e[r])<<8}(a),s.pageSize=a[0],d.vfs(`page size is ${s.pageSize}`),1024!=s.pageSize&&(console.warn(`Page size for ${e.url} is ${s.pageSize}, recommended size is 1024`),v.delete(s.id+"|0")),s.pageSize>(null!==(t=null==f?void 0:f.maxPageSize)&&void 0!==t?t:o.maxPageSize))throw new Error(`${s.pageSize} is over the maximum configured ${null!==(i=null==f?void 0:f.maxPageSize)&&void 0!==i?i:o.maxPageSize}`)}const a=BigInt(s.pageSize),c=BigInt(e.n),u=e.offset/a;u*a!==e.offset&&d.vfs(`Read chunk ${e.offset}:${e.n} is not page-aligned`);let h=u*a;if(h+a<e.offset+c)throw new Error(`Read chunk ${e.offset}:${e.n} spans across a page-boundary`);const p=s.id+"|"+u;let y=v.get(p);if(y instanceof Promise&&(y=yield y),"number"==typeof y){d.cache(`cache hit (multi-page segment) for ${e.url}:${u}`);const r=BigInt(y)*a;y=v.get(s.id+"|"+y),y instanceof Promise&&(y=yield y),y instanceof Uint8Array?h=r:y=void 0}if(void 0===y){d.cache(`cache miss for ${e.url}:${u}`);let r=s.pageSize,t=u>0&&v.get(s.id+"|"+(Number(u)-1));t&&(t instanceof Promise&&(t=yield t),"number"==typeof t&&(t=v.get(s.id+"|"+t)),t instanceof Promise&&(t=yield t),t instanceof Uint8Array&&(r=2*t.byteLength,d.cache(`downloading super page of size ${r}`)));const i=r/s.pageSize;d.http(`downloading page ${u} of size ${r} starting at ${h}`);const a=fetch(e.url,{method:"GET",headers:Object.assign(Object.assign({},null!==(n=null==f?void 0:f.headers)&&void 0!==n?n:o.headers),{Range:`bytes=${h}-${h+BigInt(r-1)}`})}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));v.set(p,a);for(let e=Number(u)+1;e<Number(u)+i;e++)v.set(s.id+"|"+e,a.then((()=>Number(u))));if(y=yield a,!(y instanceof Uint8Array)||0===y.length)throw new Error(`Invalid HTTP response received: ${JSON.stringify(a)}`);v.set(p,y);for(let e=Number(u)+1;e<Number(u)+i;e++)v.set(s.id+"|"+e,Number(u))}else d.cache(`cache hit for ${e.url}:${u}`);const w=Number(e.offset-h);return r.buffer.set(y.subarray(w,w+e.n)),0}))},xFilesize:function(e,r){return u(this,void 0,void 0,(function*(){let t=g.get(e.url);if(!t)throw new Error(`File ${e.fid} not open`);return t instanceof Promise&&(t=yield t),new BigInt64Array(r.shm,0,1)[0]=t.size,0}))}};function y({data:e}){return u(this,void 0,void 0,(function*(){let r;d.threads("Received new work message",this,e);try{r=yield m[e.msg](e,this),d.threads("operation successful",this,r),Atomics.store(this.lock,0,r)}catch(e){console.error(e),Atomics.store(this.lock,0,1)}Atomics.notify(this.lock,0)}))}if(globalThis.onmessage=({data:e})=>{var r,t,i,a;switch(d.threads("Received new control message",e),e.msg){case"handshake":{const n=new SharedArrayBuffer((null!==(r=null==f?void 0:f.maxPageSize)&&void 0!==r?r:o.maxPageSize)+Int32Array.BYTES_PER_ELEMENT),a=new Int32Array(n,null!==(t=null==f?void 0:f.maxPageSize)&&void 0!==t?t:o.maxPageSize),c=new Uint8Array(n,0,null!==(i=null==f?void 0:f.maxPageSize)&&void 0!==i?i:o.maxPageSize);Atomics.store(a,0,s.HANDSHAKE),h[e.id]={id:e.id,port:e.port,shm:n,lock:a,buffer:c},e.port.onmessage=y.bind(h[e.id]),postMessage({msg:"ack",id:e.id,shm:n,lock:a})}break;case"init":f=e.options,v=new n.A({maxSize:1024*(null!==(a=null==f?void 0:f.cacheSize)&&void 0!==a?a:o.cacheSize),sizeCalculation:e=>{var r;return null!==(r=e.byteLength)&&void 0!==r?r:4}});break;case"close":postMessage({msg:"ack"}),close();break;default:throw new Error(`Invalid message received by backend: ${e}`)}},"undefined"==typeof SharedArrayBuffer)throw new Error('SharedArrayBuffer is not available. If your browser supports it, the webserver must send "Cross-Origin-Opener-Policy: same-origin "and "Cross-Origin-Embedder-Policy: require-corp" headers.')}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,n.x=()=>{var e=n.O(void 0,[1309],(()=>n(7208)));return n.O(e)},e=[],n.O=(r,t,i,o)=>{if(!t){var s=1/0;for(l=0;l<e.length;l++){for(var[t,i,o]=e[l],a=!0,c=0;c<t.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(a=!1,o<s&&(s=o));if(a){e.splice(l--,1);var d=i();void 0!==d&&(r=d)}}return r}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[t,i,o]},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((r,t)=>(n.f[t](e,r),r)),[])),n.u=e=>e+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var r=n.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var t=r.getElementsByTagName("script");if(t.length)for(var i=t.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=t[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={4827:1};n.f.i=(r,t)=>{e[r]||importScripts(n.p+n.u(r))};var r=self.webpackChunkrlayers=self.webpackChunkrlayers||[],t=r.push.bind(r);r.push=r=>{var[i,o,s]=r;for(var a in o)n.o(o,a)&&(n.m[a]=o[a]);for(s&&s(n);i.length;)e[i.pop()]=1;t(r)}})(),r=n.x,n.x=()=>n.e(1309).then(r),n.x()})();