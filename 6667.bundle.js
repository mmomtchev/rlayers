"use strict";(self.webpackChunkrlayers=self.webpackChunkrlayers||[]).push([[6667],{6667:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var a=r(7294),n=r(6414),l=r(1090),s=r(2083),c=r(3475),o=r(9646);const i=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,u=/^H.([A-Z]{3}).*?:(.*)/,d=/^HFDTE(\d{2})(\d{2})(\d{2})/,m=/\r\n|\r|\n/;class p extends c.Z{constructor(e){super(),e=e||{},this.dataProjection=(0,n.U2)("EPSG:4326"),this.altitudeMode_=e.altitudeMode?e.altitudeMode:"none"}readFeatureFromText(e,t){const r=this.altitudeMode_,a=e.split(m),n={},c=[];let p,g,f=2e3,h=0,C=1,E=-1;for(p=0,g=a.length;p<g;++p){const e=a[p];let t;if("B"==e.charAt(0)){if(t=i.exec(e),t){const e=parseInt(t[1],10),a=parseInt(t[2],10),n=parseInt(t[3],10);let l=parseInt(t[4],10)+parseInt(t[5],10)/6e4;"S"==t[6]&&(l=-l);let s=parseInt(t[7],10)+parseInt(t[8],10)/6e4;if("W"==t[9]&&(s=-s),c.push(s,l),"none"!=r){let e;e="gps"==r?parseInt(t[11],10):"barometric"==r?parseInt(t[12],10):0,c.push(e)}let o=Date.UTC(f,h,C,e,a,n);o<E&&(o=Date.UTC(f,h,C+1,e,a,n)),c.push(o/1e3),E=o}}else"H"==e.charAt(0)&&(t=d.exec(e),t?(C=parseInt(t[1],10),h=parseInt(t[2],10)-1,f=2e3+parseInt(t[3],10)):(t=u.exec(e),t&&(n[t[1]]=t[2].trim())))}if(0===c.length)return null;const S="none"==r?"XYM":"XYZM",b=new s.Z(c,S),y=new l.Z((0,o.fI)(b,!1,t));return y.setProperties(n,!0),y}readFeaturesFromText(e,t){const r=this.readFeatureFromText(e,t);return r?[r]:[]}}const g=p;var f=r(9839),h=r(188),C=r(4467),E=r(7719);r(2031);const S=[{c:"rgba(0, 0, 250, 0.7)",i:r.p+"35f98571579c799828e73f3e7cfc5634.igc"},{c:"rgba(0, 50, 200, 0.7)",i:r.p+"08d341a63428255a9f42d1dad7e19df5.igc"},{c:"rgba(0, 100, 150, 0.7)",i:r.p+"6634c672e2855bfb2def3ad33d01b0e4.igc"},{c:"rgba(0, 150, 200, 0.7)",i:r.p+"dbecb26a49a66da3c0a27ee0ad994925.igc"},{c:"rgba(0, 200, 50, 0.7)",i:r.p+"5f9b60a43fcd910126e0dff92120e4d7.igc"}],b=(0,n.mi)([6,45.7]);function y(){const[e,t]=a.useState(""),[r,n]=a.useState(null),[l,c]=a.useState(null),[o,i]=a.useState(0),[u,d]=a.useState([]),[m,p]=a.useState({start:1/0,stop:-1/0,duration:0}),[y,w]=a.useState((()=>(Promise.all(S.map((e=>fetch(e.i).then((e=>e.text()))))).then((e=>w(e))),[]))),x={redCircle:(0,E.useRStyle)(),blueCircle:(0,E.useRStyle)(),flightPath:a.useRef([])},I=a.useRef(),M=a.useRef();return a.createElement(a.Fragment,null,a.useMemo((()=>S.map(((e,t)=>a.createElement(E.RStyle,{key:t,ref:e=>x.flightPath.current[t]=e},a.createElement(E.RStroke,{color:e.c,width:3}))))),[x.flightPath]),a.createElement(E.RStyle,{ref:x.redCircle},a.createElement(E.RStroke,{color:"red",width:1}),a.createElement(E.RCircle,{radius:6},a.createElement(E.RFill,{color:"red"}))),a.createElement(E.RStyle,{ref:x.blueCircle},a.createElement(E.RCircle,{radius:6},a.createElement(E.RFill,{color:"blue"}))),a.createElement(C.rO,{className:"example-map",initial:{center:b,zoom:9},onPointerMove:(0,a.useCallback)((e=>{const r=I.current.source.getClosestFeatureToCoordinate(e.coordinate);if(null===r)return;const a=r.getGeometry().getClosestPoint(e.coordinate),l=new Date(1e3*a[2]);n(new h.Z(a)),c(new s.Z([e.coordinate,[a[0],a[1]]])),t("<strong>"+r.get("PLT")+"</strong><br><em>"+l.toUTCString()+"</em>"),e.map.render()}),[I])},a.createElement(C.zV,{zIndex:5,url:"https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png",attributions:"Kartendaten: © OpenStreetMap-Mitwirkende, SRTM | Kartendarstellung: © OpenTopoMap (CC-BY-SA)"}),a.createElement(C.jh,{zIndex:10,ref:I,onAddFeature:(0,a.useCallback)((e=>{const t=e.feature.getGeometry();m.start=Math.min(m.start,t.getFirstCoordinate()[2]),m.stop=Math.max(m.stop,t.getLastCoordinate()[2]),m.duration=m.stop-m.start,p({...m})}),[m]),onPostRender:(0,a.useCallback)((e=>{const t=(0,f.u3)(e);t.setStyle(E.RStyle.getStyleStatic(x.redCircle)),r&&l&&(t.drawGeometry(r),t.drawGeometry(l))}),[r,l,x.redCircle])},a.useMemo((()=>a.createElement(a.Fragment,null,y.map(((e,t)=>a.createElement(C.j$,{key:t,feature:(new g).readFeatures(e,{featureProjection:"EPSG:3857"})[0],style:x.flightPath.current[t]}))))),[y,x.flightPath,x.flightPath.current[0]])),a.createElement(C.jh,{zIndex:10,ref:M,style:x.blueCircle},a.useMemo((()=>a.createElement(a.Fragment,null,u.map(((e,t)=>a.createElement(C.j$,{key:t,geometry:new h.Z(e)}))))),[u]))),a.createElement("div",{className:"d-flex flex-row mb-3 align-items-center"},a.createElement("div",{className:"jumbotron py-1 px-3 m-0 me-3 w-50",dangerouslySetInnerHTML:{__html:e}}),a.createElement("div",{className:"w-50"},a.createElement("input",{type:"range",className:"range-slider range-slider--primary w-100",min:"0",max:"100",value:o,onChange:(0,a.useCallback)((e=>{const t=parseInt(e.currentTarget.value);i(t);const r=I.current.source,a=m.start+m.duration*t/100,n=[];r.forEachFeature((e=>{if(!e.get("PLT"))return;const t=e.getGeometry().getCoordinateAtM(a,!0);n.push(t)})),d(n)}),[I,m])}))))}}}]);