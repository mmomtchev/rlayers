"use strict";(self.webpackChunkrlayers=self.webpackChunkrlayers||[]).push([[7929],{4662:(e,t,r)=>{r.d(t,{A:()=>x});var n=r(8112),o=r(1217),a=r(6702),i=r(503),s=r(2871),l=r(4294),u=r(1064),p=r(3402),c=r(5286),f=r(6391),d=r(4778),y=r(8217);class m extends y.Ay{constructor(e){super(),e=e||{},this.dataProjection=new c.A({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:d.Ay,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,r,n){e.pos=t.geometry;const o=e.readVarint()+e.pos;let a=1,i=0,s=0,l=0,u=0,p=0;for(;e.pos<o;){if(!i){const t=e.readVarint();a=7&t,i=t>>3}if(i--,1===a||2===a)s+=e.readSVarint(),l+=e.readSVarint(),1===a&&u>p&&(n.push(u),p=u),r.push(s,l),u+=2;else{if(7!==a)throw new Error("Invalid command found in the PBF");u>p&&(r.push(r[p],r[p+1]),u+=2)}}u>p&&(n.push(u),p=u)}createFeature_(e,t,r){const n=t.type;if(0===n)return null;let c;const f=t.properties;let m;this.idProperty_?(m=f[this.idProperty_],delete f[this.idProperty_]):m=t.id,f[this.layerName_]=t.layer.name;const h=[],g=[];this.readRawGeometry_(e,t,h,g);const v=function(e,t){let r;return 1===e?r=1===t?"Point":"MultiPoint":2===e?r=1===t?"LineString":"MultiLineString":3===e&&(r="Polygon"),r}(n,g.length);if(this.featureClass===d.Ay)c=new this.featureClass(v,h,g,2,f,m),c.transform(r.dataProjection);else{let e;if("Polygon"==v){const t=(0,p.yJ)(h,g);e=t.length>1?new s.A(h,"XY",t):new u.Ay(h,"XY",g)}else e="Point"===v?new l.A(h,"XY"):"LineString"===v?new o.A(h,"XY"):"MultiPoint"===v?new i.A(h,"XY"):"MultiLineString"===v?new a.A(h,"XY",g):null;c=new(0,this.featureClass),this.geometryName_&&c.setGeometryName(this.geometryName_);const t=(0,y.hX)(e,!1,r);c.setGeometry(t),void 0!==m&&c.setId(m),c.setProperties(f,!0)}return c}getType(){return"arraybuffer"}readFeatures(e,t){const r=this.layers_;t=this.adaptOptions(t);const o=(0,f.Jt)(t.dataProjection);o.setWorldExtent(t.extent),t.dataProjection=o;const a=new n.A(e),i=a.readFields(h,{}),s=[];for(const e in i){if(r&&!r.includes(e))continue;const n=i[e],l=n?[0,0,n.extent,n.extent]:null;o.setExtent(l);for(let e=0,r=n.length;e<r;++e){const r=b(a,n,e),o=this.createFeature_(a,r,t);null!==o&&s.push(o)}}return s}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function h(e,t,r){if(3===e){const e={keys:[],values:[],features:[]},n=r.readVarint()+r.pos;r.readFields(g,e,n),e.length=e.features.length,e.length&&(t[e.name]=e)}}function g(e,t,r){if(15===e)t.version=r.readVarint();else if(1===e)t.name=r.readString();else if(5===e)t.extent=r.readVarint();else if(2===e)t.features.push(r.pos);else if(3===e)t.keys.push(r.readString());else if(4===e){let n=null;const o=r.readVarint()+r.pos;for(;r.pos<o;)n=1==(e=r.readVarint()>>3)?r.readString():2===e?r.readFloat():3===e?r.readDouble():4===e?r.readVarint64():5===e?r.readVarint():6===e?r.readSVarint():7===e?r.readBoolean():null;t.values.push(n)}}function v(e,t,r){if(1==e)t.id=r.readVarint();else if(2==e){const e=r.readVarint()+r.pos;for(;r.pos<e;){const e=t.layer.keys[r.readVarint()],n=t.layer.values[r.readVarint()];t.properties[e]=n}}else 3==e?t.type=r.readVarint():4==e&&(t.geometry=r.pos)}function b(e,t,r){e.pos=t.features[r];const n=e.readVarint()+e.pos,o={layer:t,type:0,properties:{}};return e.readFields(v,o,n),o}const x=m},7929:(e,t,r)=>{r.d(t,{Gt:()=>Vo});var n={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const o=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function a(e,t){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return o.forEach((e=>{e in t&&(r[e]=t[e])})),r}class i{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function s(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}class l extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class u{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new u(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const p={kind:"null"},c={kind:"number"},f={kind:"string"},d={kind:"boolean"},y={kind:"color"},m={kind:"projectionDefinition"},h={kind:"object"},g={kind:"value"},v={kind:"collator"},b={kind:"formatted"},x={kind:"padding"},w={kind:"resolvedImage"},k={kind:"variableAnchorOffsetCollection"};function S(e,t){return{kind:"array",itemType:e,N:t}}function $(e){if("array"===e.kind){const t=$(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const z=[p,c,f,d,y,m,b,h,S(g),x,w,k];function A(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!A(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of z)if(!A(e,t))return null}return`Expected ${$(e)} but found ${$(t)} instead.`}function M(e,t){return t.some((t=>t.kind===e.kind))}function _(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function j(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const E=.96422,q=.82521,C=4/29,N=6/29,I=3*N*N,P=N*N*N,T=Math.PI/180,O=180/Math.PI;function F(e){return(e%=360)<0&&(e+=360),e}function R([e,t,r,n]){let o,a;const i=D((.2225045*(e=L(e))+.7168786*(t=L(t))+.0606169*(r=L(r)))/1);e===t&&t===r?o=a=i:(o=D((.4360747*e+.3850649*t+.1430804*r)/E),a=D((.0139322*e+.0971045*t+.7141733*r)/q));const s=116*i-16;return[s<0?0:s,500*(o-i),200*(i-a),n]}function L(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function D(e){return e>P?Math.pow(e,1/3):e/I+C}function U([e,t,r,n]){let o=(e+16)/116,a=isNaN(t)?o:o+t/500,i=isNaN(r)?o:o-r/200;return o=1*G(o),a=E*G(a),i=q*G(i),[V(3.1338561*a-1.6168667*o-.4906146*i),V(-.9787684*a+1.9161415*o+.033454*i),V(.0719453*a-.2289914*o+1.4052427*i),n]}function V(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function G(e){return e>N?e*e*e:I*(e-C)}function J(e){return parseInt(e.padEnd(2,e),16)/255}function W(e,t){return B(t?e/100:e,0,1)}function B(e,t,r){return Math.min(Math.max(t,e),r)}function X(e){return!e.some(Number.isNaN)}const Z={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Y(e,t,r){return e+r*(t-e)}function K(e,t,r){return e.map(((e,n)=>Y(e,t[n],r)))}class H{constructor(e,t,r,n=1,o=!0){this.r=e,this.g=t,this.b=r,this.a=n,o||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof H)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=Z[e];if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let r=1;return[J(e.slice(r,r+=t)),J(e.slice(r,r+=t)),J(e.slice(r,r+=t)),J(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){const t=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=e.match(t);if(r){const[e,t,n,o,a,i,s,l,u,p,c,f]=r,d=[o||" ",s||" ",p].join("");if("  "===d||"  /"===d||",,"===d||",,,"===d){const e=[n,i,u].join(""),r="%%%"===e?100:""===e?255:0;if(r){const e=[B(+t/r,0,1),B(+a/r,0,1),B(+l/r,0,1),c?W(+c,f):1];if(X(e))return e}}return}}const r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){const[e,t,n,o,a,i,s,l,u]=r,p=[n||" ",a||" ",s].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[+t,B(+o,0,100),B(+i,0,100),l?W(+l,u):1];if(X(e))return function([e,t,r,n]){function o(n){const o=(n+e/30)%12,a=t*Math.min(r,1-r);return r-a*Math.max(-1,Math.min(o-3,9-o,1))}return e=F(e),t/=100,r/=100,[o(0),o(8),o(4),n]}(e)}}}(e);return t?new H(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,o=n||1/0;return this.overwriteGetter("rgb",[e/o,t/o,r/o,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,r,n,o]=R(e),a=Math.sqrt(r*r+n*n);return[Math.round(1e4*a)?F(Math.atan2(n,r)*O):NaN,a,t,o]}(this.rgb))}get lab(){return this.overwriteGetter("lab",R(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map((e=>Math.round(255*e))).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,o,a,i]=K(e.rgb,t.rgb,r);return new H(n,o,a,i,!1)}case"hcl":{const[n,o,a,i]=e.hcl,[s,l,u,p]=t.hcl;let c,f;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?c=NaN:(c=s,1!==a&&0!==a||(f=l)):(c=n,1!==u&&0!==u||(f=o));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),c=n+r*e}const[d,y,m,h]=function([e,t,r,n]){return e=isNaN(e)?0:e*T,U([r,Math.cos(e)*t,Math.sin(e)*t,n])}([c,null!=f?f:Y(o,l,r),Y(a,u,r),Y(i,p,r)]);return new H(d,y,m,h,!1)}case"lab":{const[n,o,a,i]=U(K(e.lab,t.lab,r));return new H(n,o,a,i,!1)}}}}H.black=new H(0,0,0,1),H.white=new H(1,1,1,1),H.transparent=new H(0,0,0,0),H.red=new H(1,0,0,1);class Q{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ee=["bottom","center","top"];class te{constructor(e,t,r,n,o,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=o,this.verticalAlign=a}}class re{constructor(e){this.sections=e}static fromString(e){return new re([new te(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof re?e:re.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class ne{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ne)return e;if("number"==typeof e)return new ne([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ne(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new ne(K(e.values,t.values,r))}}class oe{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ae=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ie{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ie)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!=typeof r||!ae.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new ie(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,o=t.values;if(n.length!==o.length)throw new oe(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const a=[];for(let e=0;e<n.length;e+=2){if(n[e]!==o[e])throw new oe(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${n[e]}, to[${e}]: ${o[e]}`);a.push(n[e]);const[t,i]=n[e+1],[s,l]=o[e+1];a.push([Y(t,s,r),Y(i,l,r)])}return new ie(a)}}class se{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new se({name:e,available:!1}):null}}class le{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new le(e,t,r)}static parse(e){return e instanceof le?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new le(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new le(e.from,e.to,e.transition):"string"==typeof e?new le(e,e,1):void 0}}function ue(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pe(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof le||e instanceof H||e instanceof Q||e instanceof re||e instanceof ne||e instanceof ie||e instanceof se)return!0;if(Array.isArray(e)){for(const t of e)if(!pe(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!pe(e[t]))return!1;return!0}return!1}function ce(e){if(null===e)return p;if("string"==typeof e)return f;if("boolean"==typeof e)return d;if("number"==typeof e)return c;if(e instanceof H)return y;if(e instanceof le)return m;if(e instanceof Q)return v;if(e instanceof re)return b;if(e instanceof ne)return x;if(e instanceof ie)return k;if(e instanceof se)return w;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=ce(t);if(r){if(r===e)continue;r=g;break}r=e}return S(r||g,t)}return h}function fe(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof H||e instanceof le||e instanceof re||e instanceof ne||e instanceof ie||e instanceof se?e.toString():JSON.stringify(e)}class de{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!pe(e[1]))return t.error("invalid value");const r=e[1];let n=ce(r);const o=t.expectedType;return"array"!==n.kind||0!==n.N||!o||"array"!==o.kind||"number"==typeof o.N&&0!==o.N||(n=o),new de(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ye={string:f,number:c,boolean:d,object:h};class me{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const o=e[0];if("array"===o){let o,a;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in ye)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=ye[r],n++}else o=g;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],n++}r=S(o,a)}else{if(!ye[o])throw new Error(`Types doesn't contain name = ${o}`);r=ye[o]}const a=[];for(;n<e.length;n++){const r=t.parse(e[n],n,g);if(!r)return null;a.push(r)}return new me(r,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!A(this.type,ce(r)))return r;if(t===this.args.length-1)throw new oe(`Expected value to be of type ${$(this.type)}, but found ${$(ce(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const he={"to-boolean":d,"to-color":y,"to-number":c,"to-string":f};class ge{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!he[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=he[r],o=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,g);if(!n)return null;o.push(n)}return new ge(n,o)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof H)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:ue(t[0],t[1],t[2],t[3]),!r))return new H(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new oe(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=ne.parse(t);if(n)return n}throw new oe(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=ie.parse(t);if(n)return n}throw new oe(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new oe(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return re.fromString(fe(this.args[0].evaluate(e)));case"resolvedImage":return se.fromString(fe(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return fe(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ve=["Unknown","Point","LineString","Polygon"];class be{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ve[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=H.parse(e)),t}}class xe{constructor(e,t,r=[],n,o=new u,a=[]){this.registry=e,this.path=r,this.key=r.map((e=>`[${e}]`)).join(""),this.scope=o,this.errors=a,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,o={}){return t?this.concat(t,r,n)._parse(e,o):this._parse(e,o)}_parse(e,t){function r(e,t,r){return"assert"===r?new me(t,[e]):"coerce"===r?new ge(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const o=this.registry[n];if(o){let n=o.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,o=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==o.kind)if("projectionDefinition"!==e.kind||"string"!==o.kind&&"array"!==o.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==o.kind&&"string"!==o.kind)if("padding"!==e.kind||"value"!==o.kind&&"number"!==o.kind&&"array"!==o.kind)if("variableAnchorOffsetCollection"!==e.kind||"value"!==o.kind&&"array"!==o.kind){if(this.checkSubtype(e,o))return null}else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof de)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const e=new be;try{n=new de(n.type,n.evaluate(e))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new xe(this.registry,this._isConstant,n,t||null,o,this.errors)}error(e,...t){const r=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new l(r,e))}checkSubtype(e,t){const r=A(e,t);return r&&this.error(r),r}}class we{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let n=1;n<e.length-1;n+=2){const o=e[n];if("string"!=typeof o)return t.error(`Expected string, but found ${typeof o} instead.`,n);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const a=t.parse(e[n+1],n+1);if(!a)return null;r.push([o,a])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new we(r,n):null}outputDefined(){return this.result.outputDefined()}}class ke{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new ke(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Se{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,c),n=t.parse(e[2],2,S(t.expectedType||g));if(!r||!n)return null;const o=n.type;return new Se(o.itemType,r,n)}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new oe(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new oe(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new oe(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class $e{constructor(e,t){this.type=d,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,g),n=t.parse(e[2],2,g);return r&&n?M(r.type,[d,f,c,p,g])?new $e(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!_(t,["boolean","string","number","null"]))throw new oe(`Expected first argument to be of type boolean, string, number or null, but found ${$(ce(t))} instead.`);if(!_(r,["string","array"]))throw new oe(`Expected second argument to be of type array or string, but found ${$(ce(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class ze{constructor(e,t,r){this.type=c,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,g),n=t.parse(e[2],2,g);if(!r||!n)return null;if(!M(r.type,[d,f,c,p,g]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,c);return o?new ze(r,n,o):null}return new ze(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!_(t,["boolean","string","number","null"]))throw new oe(`Expected first argument to be of type boolean, string, number or null, but found ${$(ce(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),_(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(_(r,["array"]))return r.indexOf(t,n);throw new oe(`Expected second argument to be of type array or string, but found ${$(ce(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Ae{constructor(e,t,r,n,o,a){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=o,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const o={},a=[];for(let i=2;i<e.length-1;i+=2){let s=e[i];const l=e[i+1];Array.isArray(s)||(s=[s]);const u=t.concat(i);if(0===s.length)return u.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ce(e)))return null}else r=ce(e);if(void 0!==o[String(e)])return u.error("Branch labels must be unique.");o[String(e)]=a.length}const p=t.parse(l,i,n);if(!p)return null;n=n||p.type,a.push(p)}const i=t.parse(e[1],1,g);if(!i)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==i.type.kind&&t.concat(1).checkSubtype(r,i.type)?null:new Ae(r,n,i,o,a,s):null}evaluate(e){const t=this.input.evaluate(e);return(ce(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class Me{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let o=1;o<e.length-1;o+=2){const a=t.parse(e[o],o,d);if(!a)return null;const i=t.parse(e[o+1],o+1,r);if(!i)return null;n.push([a,i]),r=r||i.type}const o=t.parse(e[e.length-1],e.length-1,r);if(!o)return null;if(!r)throw new Error("Can't infer output type");return new Me(r,n,o)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}}class _e{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,g),n=t.parse(e[2],2,c);if(!r||!n)return null;if(!M(r.type,[S(g),f,g]))return t.error(`Expected first argument to be of type array or string, but found ${$(r.type)} instead`);if(4===e.length){const o=t.parse(e[3],3,c);return o?new _e(r.type,r,n,o):null}return new _e(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),_(t,["string"]))return[...t].slice(r,n).join("");if(_(t,["array"]))return t.slice(r,n);throw new oe(`Expected first argument to be of type array or string, but found ${$(ce(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function je(e,t){const r=e.length-1;let n,o,a=0,i=r,s=0;for(;a<=i;)if(s=Math.floor((a+i)/2),n=e[s],o=e[s+1],n<=t){if(s===r||t<o)return s;a=s+1}else{if(!(n>t))throw new oe("Input is not a number.");i=s-1}return 0}class Ee{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,c);if(!r)return null;const n=[];let o=null;t.expectedType&&"value"!==t.expectedType.kind&&(o=t.expectedType);for(let r=1;r<e.length;r+=2){const a=1===r?-1/0:e[r],i=e[r+1],s=r,l=r+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=t.parse(i,l,o);if(!u)return null;o=o||u.type,n.push([a,u])}return new Ee(o,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;return n>=t[o-1]?r[o-1].evaluate(e):r[je(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function qe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ce,Ne,Ie=function(){if(Ne)return Ce;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return Ne=1,Ce=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var o=this.sampleCurveX(r)-e;if(Math.abs(o)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}var i=0,s=1;for(r=e,n=0;n<20&&(o=this.sampleCurveX(r),!(Math.abs(o-e)<t));n++)e>o?i=r:s=r,r=.5*(s-i)+i;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},Ce}(),Pe=qe(Ie);class Te{constructor(e,t,r,n,o){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of o)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,n){let o=0;if("exponential"===e.name)o=Oe(t,e.base,r,n);else if("linear"===e.name)o=Oe(t,1,r,n);else if("cubic-bezier"===e.name){const a=e.controlPoints;o=new Pe(a[0],a[1],a[2],a[3]).solve(Oe(t,1,r,n))}return o}static parse(e,t){let[r,n,o,...a]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(o=t.parse(o,2,c),!o)return null;const i=[];let s=null;"interpolate-hcl"===r||"interpolate-lab"===r?s=y:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let e=0;e<a.length;e+=2){const r=a[e],n=a[e+1],o=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(i.length&&i[i.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',o);const u=t.parse(n,l,s);if(!u)return null;s=s||u.type,i.push([r,u])}return j(s,c)||j(s,m)||j(s,y)||j(s,x)||j(s,k)||j(s,S(c))?new Te(s,r,n,o,i):t.error(`Type ${$(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const o=t.length;if(n>=t[o-1])return r[o-1].evaluate(e);const a=je(t,n),i=t[a],s=t[a+1],l=Te.interpolationFactor(this.interpolation,n,i,s),u=r[a].evaluate(e),p=r[a+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Y(u,p,l);case"color":return H.interpolate(u,p,l);case"padding":return ne.interpolate(u,p,l);case"variableAnchorOffsetCollection":return ie.interpolate(u,p,l);case"array":return K(u,p,l);case"projectionDefinition":return le.interpolate(u,p,l)}case"interpolate-hcl":return H.interpolate(u,p,l,"hcl");case"interpolate-lab":return H.interpolate(u,p,l,"lab")}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Oe(e,t,r,n){const o=n-r,a=e-r;return 0===o?0:1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1)}H.interpolate,ne.interpolate,ie.interpolate;class Fe{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const o=[];for(const n of e.slice(1)){const e=t.parse(n,1+o.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,o.push(e)}if(!r)throw new Error("No output type");const a=n&&o.some((e=>A(n,e.type)));return new Fe(a?g:r,o)}evaluate(e){let t,r=null,n=0;for(const o of this.args)if(n++,r=o.evaluate(e),r&&r instanceof se&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Re(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Le(e,t,r,n){return 0===n.compare(t,r)}function De(e,t,r){const n="=="!==e&&"!="!==e;return class o{constructor(e,t,r){this.type=d,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let a=t.parse(e[1],1,g);if(!a)return null;if(!Re(r,a.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${$(a.type)}'.`);let i=t.parse(e[2],2,g);if(!i)return null;if(!Re(r,i.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${$(i.type)}'.`);if(a.type.kind!==i.type.kind&&"value"!==a.type.kind&&"value"!==i.type.kind)return t.error(`Cannot compare types '${$(a.type)}' and '${$(i.type)}'.`);n&&("value"===a.type.kind&&"value"!==i.type.kind?a=new me(i.type,[a]):"value"!==a.type.kind&&"value"===i.type.kind&&(i=new me(a.type,[i])));let s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==i.type.kind&&"value"!==a.type.kind&&"value"!==i.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,v),!s)return null}return new o(a,i,s)}evaluate(o){const a=this.lhs.evaluate(o),i=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){const t=ce(a),r=ce(i);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new oe(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=ce(a),r=ce(i);if("string"!==e.kind||"string"!==r.kind)return t(o,a,i)}return this.collator?r(o,a,i,this.collator.evaluate(o)):t(o,a,i)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const Ue=De("==",(function(e,t,r){return t===r}),Le),Ve=De("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!Le(0,t,r,n)})),Ge=De("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),Je=De(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),We=De("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),Be=De(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0}));class Xe{constructor(e,t,r){this.type=v,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,d);if(!n)return null;const o=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,d);if(!o)return null;let a=null;return r.locale&&(a=t.parse(r.locale,1,f),!a)?null:new Xe(n,o,a)}evaluate(e){return new Q(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Ze{constructor(e,t,r,n,o){this.type=f,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,c);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let o=null;if(n.locale&&(o=t.parse(n.locale,1,f),!o))return null;let a=null;if(n.currency&&(a=t.parse(n.currency,1,f),!a))return null;let i=null;if(n["min-fraction-digits"]&&(i=t.parse(n["min-fraction-digits"],1,c),!i))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,c),!s)?null:new Ze(r,o,a,i,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ye{constructor(e){this.type=b,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let o=!1;for(let r=1;r<=e.length-1;++r){const a=e[r];if(o&&"object"==typeof a&&!Array.isArray(a)){o=!1;let e=null;if(a["font-scale"]&&(e=t.parse(a["font-scale"],1,c),!e))return null;let r=null;if(a["text-font"]&&(r=t.parse(a["text-font"],1,S(f)),!r))return null;let i=null;if(a["text-color"]&&(i=t.parse(a["text-color"],1,y),!i))return null;let s=null;if(a["vertical-align"]){if("string"==typeof a["vertical-align"]&&!ee.includes(a["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(s=t.parse(a["vertical-align"],1,f),!s)return null}const l=n[n.length-1];l.scale=e,l.font=r,l.textColor=i,l.verticalAlign=s}else{const a=t.parse(e[r],1,g);if(!a)return null;const i=a.type.kind;if("string"!==i&&"value"!==i&&"null"!==i&&"resolvedImage"!==i)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,n.push({content:a,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ye(n)}evaluate(e){return new re(this.sections.map((t=>{const r=t.content.evaluate(e);return ce(r)===w?new te("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new te(fe(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Ke{constructor(e){this.type=w,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,f);return r?new Ke(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=se.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class He{constructor(e){this.type=c,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${$(r.type)} instead.`):new He(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new oe(`Expected value to be of type string or array, but found ${$(ce(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Qe=8192;function et(e,t){const r=(180+e[0])/360,n=(o=e[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360);var o;const a=Math.pow(2,t.z);return[Math.round(r*a*Qe),Math.round(n*a*Qe)]}function tt(e,t){const r=Math.pow(2,t.z);return[(o=(e[0]/Qe+t.x)/r,360*o-180),(n=(e[1]/Qe+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90)];var n,o}function rt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function nt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ot(e,t,r){const n=e[0]-t[0],o=e[1]-t[1],a=e[0]-r[0],i=e[1]-r[1];return n*i-a*o==0&&n*a<=0&&o*i<=0}function at(e,t,r,n){const o=[t[0]-e[0],t[1]-e[1]];return 0!=(a=[n[0]-r[0],n[1]-r[1]])[0]*(i=o)[1]-a[1]*i[0]&&!(!ct(e,t,r,n)||!ct(r,n,e,t));var a,i}function it(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(at(e,t,n[r],n[r+1]))return!0;return!1}function st(e,t,r=!1){let n=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(ot(e,s[t],s[t+1]))return r;o=e,a=s[t],i=s[t+1],a[1]>o[1]!=i[1]>o[1]&&o[0]<(i[0]-a[0])*(o[1]-a[1])/(i[1]-a[1])+a[0]&&(n=!n)}var o,a,i;return n}function lt(e,t){for(const r of t)if(st(e,r))return!0;return!1}function ut(e,t){for(const r of e)if(!st(r,t))return!1;for(let r=0;r<e.length-1;++r)if(it(e[r],e[r+1],t))return!1;return!0}function pt(e,t){for(const r of t)if(ut(e,r))return!0;return!1}function ct(e,t,r,n){const o=e[0]-r[0],a=e[1]-r[1],i=t[0]-r[0],s=t[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],p=o*u-l*a,c=i*u-l*s;return p>0&&c<0||p<0&&c>0}function ft(e,t,r){const n=[];for(let o=0;o<e.length;o++){const a=[];for(let n=0;n<e[o].length;n++){const i=et(e[o][n],r);rt(t,i),a.push(i)}n.push(a)}return n}function dt(e,t,r){const n=[];for(let o=0;o<e.length;o++){const a=ft(e[o],t,r);n.push(a)}return n}function yt(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let o=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===o&&(o=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=o}rt(t,e)}function mt(e,t,r,n){const o=Math.pow(2,n.z)*Qe,a=[n.x*Qe,n.y*Qe],i=[];for(const n of e)for(const e of n){const n=[e.x+a[0],e.y+a[1]];yt(n,t,r,o),i.push(n)}return i}function ht(e,t,r,n){const o=Math.pow(2,n.z)*Qe,a=[n.x*Qe,n.y*Qe],i=[];for(const r of e){const e=[];for(const n of r){const r=[n.x+a[0],n.y+a[1]];rt(t,r),e.push(r)}i.push(e)}if(t[2]-t[0]<=o/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of i)for(const n of e)yt(n,t,r,o)}var s;return i}class gt{constructor(e,t){this.type=d,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(pe(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length)return new gt(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new gt(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new gt(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const a=ft(t.coordinates,n,o),i=mt(e.geometry(),r,n,o);if(!nt(r,n))return!1;for(const e of i)if(!st(e,a))return!1}if("MultiPolygon"===t.type){const a=dt(t.coordinates,n,o),i=mt(e.geometry(),r,n,o);if(!nt(r,n))return!1;for(const e of i)if(!lt(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],o=e.canonicalID();if("Polygon"===t.type){const a=ft(t.coordinates,n,o),i=ht(e.geometry(),r,n,o);if(!nt(r,n))return!1;for(const e of i)if(!ut(e,a))return!1}if("MultiPolygon"===t.type){const a=dt(t.coordinates,n,o),i=ht(e.geometry(),r,n,o);if(!nt(r,n))return!1;for(const e of i)if(!pt(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class vt{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const o=e-1>>1,a=t[o];if(r(n,a)>=0)break;t[e]=a,e=o}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,o=t[e];for(;e<n;){let n=1+(e<<1);const a=n+1;if(a<this.length&&r(t[a],t[n])<0&&(n=a),r(t[n],o)>=0)break;t[e]=t[n],e=n}t[e]=o}}function bt(e){let t=0;for(let r,n,o=0,a=e.length,i=a-1;o<a;i=o++)r=e[o],n=e[i],t+=(n.x-r.x)*(r.y+n.y);return t}const xt=1/298.257223563,wt=xt*(2-xt),kt=Math.PI/180;class St{constructor(e){const t=6378.137*kt*1e3,r=Math.cos(e*kt),n=1/(1-wt*(1-r*r)),o=Math.sqrt(n);this.kx=t*o*r,this.ky=t*o*n*(1-wt)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,o,a,i=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],u=e[s][1],p=this.wrap(e[s+1][0]-l)*this.kx,c=(e[s+1][1]-u)*this.ky,f=0;0===p&&0===c||(f=(this.wrap(t[0]-l)*this.kx*p+(t[1]-u)*this.ky*c)/(p*p+c*c),f>1?(l=e[s+1][0],u=e[s+1][1]):f>0&&(l+=p/this.kx*f,u+=c/this.ky*f)),p=this.wrap(t[0]-l)*this.kx,c=(t[1]-u)*this.ky;const d=p*p+c*c;d<i&&(i=d,r=l,n=u,o=s,a=f)}return{point:[r,n],index:o,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function $t(e,t){return t[0]-e[0]}function zt(e){return e[1]-e[0]+1}function At(e,t){return e[1]>=e[0]&&e[1]<t}function Mt(e,t){if(e[0]>e[1])return[null,null];const r=zt(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function _t(e,t){if(!At(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)rt(r,e[n]);return r}function jt(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)rt(t,e);return t}function Et(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function qt(e,t,r){if(!Et(e)||!Et(t))return NaN;let n=0,o=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(o=e[1]-t[3]),e[3]<t[1]&&(o=t[1]-e[3]),r.distance([0,0],[n,o])}function Ct(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function Nt(e,t,r,n,o){const a=Math.min(Ct(e,[r,n],o),Ct(t,[r,n],o)),i=Math.min(Ct(r,[e,t],o),Ct(n,[e,t],o));return Math.min(a,i)}function It(e,t,r,n,o){if(!At(t,e.length)||!At(n,r.length))return 1/0;let a=1/0;for(let i=t[0];i<t[1];++i){const t=e[i],s=e[i+1];for(let e=n[0];e<n[1];++e){const n=r[e],i=r[e+1];if(at(t,s,n,i))return 0;a=Math.min(a,Nt(t,s,n,i,o))}}return a}function Pt(e,t,r,n,o){if(!At(t,e.length)||!At(n,r.length))return NaN;let a=1/0;for(let i=t[0];i<=t[1];++i)for(let t=n[0];t<=n[1];++t)if(a=Math.min(a,o.distance(e[i],r[t])),0===a)return a;return a}function Tt(e,t,r){if(st(e,t,!0))return 0;let n=1/0;for(const o of t){const t=o[0],a=o[o.length-1];if(t!==a&&(n=Math.min(n,Ct(e,[a,t],r)),0===n))return n;const i=r.pointOnLine(o,e);if(n=Math.min(n,r.distance(e,i.point)),0===n)return n}return n}function Ot(e,t,r,n){if(!At(t,e.length))return NaN;for(let n=t[0];n<=t[1];++n)if(st(e[n],r,!0))return 0;let o=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],i=e[a+1];for(const e of r)for(let r=0,a=e.length,s=a-1;r<a;s=r++){const a=e[s],l=e[r];if(at(t,i,a,l))return 0;o=Math.min(o,Nt(t,i,a,l,n))}}return o}function Ft(e,t){for(const r of e)for(const e of r)if(st(e,t,!0))return!0;return!1}function Rt(e,t,r,n=1/0){const o=jt(e),a=jt(t);if(n!==1/0&&qt(o,a,r)>=n)return n;if(nt(o,a)){if(Ft(e,t))return 0}else if(Ft(t,e))return 0;let i=1/0;for(const n of e)for(let e=0,o=n.length,a=o-1;e<o;a=e++){const o=n[a],s=n[e];for(const e of t)for(let t=0,n=e.length,a=n-1;t<n;a=t++){const n=e[a],l=e[t];if(at(o,s,n,l))return 0;i=Math.min(i,Nt(o,s,n,l,r))}}return i}function Lt(e,t,r,n,o,a){if(!a)return;const i=qt(_t(n,a),o,r);i<t&&e.push([i,a,[0,0]])}function Dt(e,t,r,n,o,a,i){if(!a||!i)return;const s=qt(_t(n,a),_t(o,i),r);s<t&&e.push([s,a,i])}function Ut(e,t,r,n,o=1/0){let a=Math.min(n.distance(e[0],r[0][0]),o);if(0===a)return a;const i=new vt([[0,[0,e.length-1],[0,0]]],$t),s=jt(r);for(;i.length>0;){const o=i.pop();if(o[0]>=a)continue;const l=o[1],u=t?50:100;if(zt(l)<=u){if(!At(l,e.length))return NaN;if(t){const t=Ot(e,l,r,n);if(isNaN(t)||0===t)return t;a=Math.min(a,t)}else for(let t=l[0];t<=l[1];++t){const o=Tt(e[t],r,n);if(a=Math.min(a,o),0===a)return 0}}else{const r=Mt(l,t);Lt(i,a,n,e,s,r[0]),Lt(i,a,n,e,s,r[1])}}return a}function Vt(e,t,r,n,o,a=1/0){let i=Math.min(a,o.distance(e[0],r[0]));if(0===i)return i;const s=new vt([[0,[0,e.length-1],[0,r.length-1]]],$t);for(;s.length>0;){const a=s.pop();if(a[0]>=i)continue;const l=a[1],u=a[2],p=t?50:100,c=n?50:100;if(zt(l)<=p&&zt(u)<=c){if(!At(l,e.length)&&At(u,r.length))return NaN;let a;if(t&&n)a=It(e,l,r,u,o),i=Math.min(i,a);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(a=Ct(r[e],t,o),i=Math.min(i,a),0===i)return i}else if(!t&&n){const t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(a=Ct(e[r],t,o),i=Math.min(i,a),0===i)return i}else a=Pt(e,l,r,u,o),i=Math.min(i,a)}else{const a=Mt(l,t),p=Mt(u,n);Dt(s,i,o,e,r,a[0],p[0]),Dt(s,i,o,e,r,a[0],p[1]),Dt(s,i,o,e,r,a[1],p[0]),Dt(s,i,o,e,r,a[1],p[1])}}return i}function Gt(e){return"MultiPolygon"===e.type?e.coordinates.map((e=>({type:"Polygon",coordinates:e}))):"MultiLineString"===e.type?e.coordinates.map((e=>({type:"LineString",coordinates:e}))):"MultiPoint"===e.type?e.coordinates.map((e=>({type:"Point",coordinates:e}))):[e]}class Jt{constructor(e,t){this.type=c,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(pe(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Jt(t,t.features.map((e=>Gt(e.geometry))).flat());if("Feature"===t.type)return new Jt(t,Gt(t.geometry));if("type"in t&&"coordinates"in t)return new Jt(t,Gt(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>tt([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const o=new St(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Vt(n,!1,[e.coordinates],!1,o,a));break;case"LineString":a=Math.min(a,Vt(n,!1,e.coordinates,!0,o,a));break;case"Polygon":a=Math.min(a,Ut(n,!1,e.coordinates,o,a))}if(0===a)return a}return a}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>tt([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const o=new St(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Vt(n,!0,[e.coordinates],!1,o,a));break;case"LineString":a=Math.min(a,Vt(n,!0,e.coordinates,!0,o,a));break;case"Polygon":a=Math.min(a,Ut(n,!0,e.coordinates,o,a))}if(0===a)return a}return a}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=function(e){if(e.length<=1)return[e];const t=[];let r,n;for(const o of e){const e=bt(o);0!==e&&(o.area=Math.abs(e),void 0===n&&(n=e<0),n===e<0?(r&&t.push(r),r=[o]):r.push(o))}return r&&t.push(r),t}(r).map((t=>t.map((t=>t.map((t=>tt([t.x,t.y],e.canonical))))))),o=new St(n[0][0][0][1]);let a=1/0;for(const e of t)for(const t of n){switch(e.type){case"Point":a=Math.min(a,Ut([e.coordinates],!1,t,o,a));break;case"LineString":a=Math.min(a,Ut(e.coordinates,!0,t,o,a));break;case"Polygon":a=Math.min(a,Rt(t,e.coordinates,o,a))}if(0===a)return a}return a}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Wt={"==":Ue,"!=":Ve,">":Je,"<":Ge,">=":Be,"<=":We,array:me,at:Se,boolean:me,case:Me,coalesce:Fe,collator:Xe,format:Ye,image:Ke,in:$e,"index-of":ze,interpolate:Te,"interpolate-hcl":Te,"interpolate-lab":Te,length:He,let:we,literal:de,match:Ae,number:me,"number-format":Ze,object:me,slice:_e,step:Ee,string:me,"to-boolean":ge,"to-color":ge,"to-number":ge,"to-string":ge,var:ke,within:gt,distance:Jt};class Bt{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=Bt.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const o=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,i=a.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let s=null;for(const[n,a]of i){s=new xe(t.registry,Ht,t.path,null,t.scope);const i=[];let l=!1;for(let t=1;t<e.length;t++){const r=e[t],o=Array.isArray(n)?n[t-1]:n.type,a=s.parse(r,1+i.length,o);if(!a){l=!0;break}i.push(a)}if(!l)if(Array.isArray(n)&&n.length!==i.length)s.error(`Expected ${n.length} arguments, but found ${i.length} instead.`);else{for(let e=0;e<i.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=i[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new Bt(r,o,a,i)}}if(1===i.length)t.errors.push(...s.errors);else{const r=(i.length?i:a).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map($).join(", ")})`:`(${$(t.type)}...)`;var t})).join(" | "),n=[];for(let r=1;r<e.length;r++){const o=t.parse(e[r],1+n.length);if(!o)return null;n.push($(o.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Bt.definitions=t;for(const r in t)e[r]=Bt}}function Xt(e,[t,r,n,o]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const a=o?o.evaluate(e):1,i=ue(t,r,n,a);if(i)throw new oe(i);return new H(t/255,r/255,n/255,a,!1)}function Zt(e,t){return e in t}function Yt(e,t){const r=t[e];return void 0===r?null:r}function Kt(e){return{type:e}}function Ht(e){if(e instanceof ke)return Ht(e.boundExpression);if(e instanceof Bt&&"error"===e.name)return!1;if(e instanceof Xe)return!1;if(e instanceof gt)return!1;if(e instanceof Jt)return!1;const t=e instanceof ge||e instanceof me;let r=!0;return e.eachChild((e=>{r=t?r&&Ht(e):r&&e instanceof de})),!!r&&Qt(e)&&tr(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Qt(e){if(e instanceof Bt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof gt)return!1;if(e instanceof Jt)return!1;let t=!0;return e.eachChild((e=>{t&&!Qt(e)&&(t=!1)})),t}function er(e){if(e instanceof Bt&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!er(e)&&(t=!1)})),t}function tr(e,t){if(e instanceof Bt&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!tr(e,t)&&(r=!1)})),r}function rr(e){return{result:"success",value:e}}function nr(e){return{result:"error",value:e}}function or(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function ar(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ir(e){return!!e.expression&&e.expression.interpolated}function sr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function lr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}Bt.register(Wt,{error:[{kind:"error"},[f],(e,[t])=>{throw new oe(t.evaluate(e))}],typeof:[f,[g],(e,[t])=>$(ce(t.evaluate(e)))],"to-rgba":[S(c,4),[y],(e,[t])=>{const[r,n,o,a]=t.evaluate(e).rgb;return[255*r,255*n,255*o,a]}],rgb:[y,[c,c,c],Xt],rgba:[y,[c,c,c,c],Xt],has:{type:d,overloads:[[[f],(e,[t])=>Zt(t.evaluate(e),e.properties())],[[f,h],(e,[t,r])=>Zt(t.evaluate(e),r.evaluate(e))]]},get:{type:g,overloads:[[[f],(e,[t])=>Yt(t.evaluate(e),e.properties())],[[f,h],(e,[t,r])=>Yt(t.evaluate(e),r.evaluate(e))]]},"feature-state":[g,[f],(e,[t])=>Yt(t.evaluate(e),e.featureState||{})],properties:[h,[],e=>e.properties()],"geometry-type":[f,[],e=>e.geometryType()],id:[g,[],e=>e.id()],zoom:[c,[],e=>e.globals.zoom],"heatmap-density":[c,[],e=>e.globals.heatmapDensity||0],"line-progress":[c,[],e=>e.globals.lineProgress||0],accumulated:[g,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[c,Kt(c),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[c,Kt(c),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:c,overloads:[[[c,c],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[c],(e,[t])=>-t.evaluate(e)]]},"/":[c,[c,c],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[c,[c,c],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[c,[],()=>Math.LN2],pi:[c,[],()=>Math.PI],e:[c,[],()=>Math.E],"^":[c,[c,c],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[c,[c],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[c,[c],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[c,[c],(e,[t])=>Math.log(t.evaluate(e))],log2:[c,[c],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[c,[c],(e,[t])=>Math.sin(t.evaluate(e))],cos:[c,[c],(e,[t])=>Math.cos(t.evaluate(e))],tan:[c,[c],(e,[t])=>Math.tan(t.evaluate(e))],asin:[c,[c],(e,[t])=>Math.asin(t.evaluate(e))],acos:[c,[c],(e,[t])=>Math.acos(t.evaluate(e))],atan:[c,[c],(e,[t])=>Math.atan(t.evaluate(e))],min:[c,Kt(c),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[c,Kt(c),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[c,[c],(e,[t])=>Math.abs(t.evaluate(e))],round:[c,[c],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[c,[c],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[c,[c],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[d,[f,g],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[d,[g],(e,[t])=>e.id()===t.value],"filter-type-==":[d,[f],(e,[t])=>e.geometryType()===t.value],"filter-<":[d,[f,g],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n<o}],"filter-id-<":[d,[g],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[d,[f,g],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n>o}],"filter-id->":[d,[g],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[d,[f,g],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n<=o}],"filter-id-<=":[d,[g],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[d,[f,g],(e,[t,r])=>{const n=e.properties()[t.value],o=r.value;return typeof n==typeof o&&n>=o}],"filter-id->=":[d,[g],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[d,[g],(e,[t])=>t.value in e.properties()],"filter-has-id":[d,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[d,[S(f)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[d,[S(g)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[d,[f,S(g)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[d,[f,S(g)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const o=r+n>>1;if(t[o]===e)return!0;t[o]>e?n=o-1:r=o+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:d,overloads:[[[d,d],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Kt(d),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:d,overloads:[[[d,d],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Kt(d),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[d,[d],(e,[t])=>!t.evaluate(e)],"is-supported-script":[d,[f],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[f,[f],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[f,[f],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[f,Kt(g),(e,t)=>t.map((t=>fe(t.evaluate(e)))).join("")],"resolved-locale":[f,[v],(e,[t])=>t.evaluate(e).resolvedLocale()]});class ur{constructor(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new be,this._defaultValue=t?"color"===(r=t).type&&lr(r.default)?new H(0,0,0,0):"color"===r.type?H.parse(r.default)||null:"padding"===r.type?ne.parse(r.default)||null:"variableAnchorOffsetCollection"===r.type?ie.parse(r.default)||null:"projectionDefinition"===r.type?le.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,o,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,o,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new oe(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function pr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Wt}function cr(e,t){const r=new xe(Wt,Ht,[],t?function(e){const t={color:y,string:f,number:c,enum:f,boolean:d,formatted:b,padding:x,projectionDefinition:m,resolvedImage:w,variableAnchorOffsetCollection:k};return"array"===e.type?S(t[e.value]||g,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?rr(new ur(n,t)):nr(r.errors)}class fr{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!er(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,a)}evaluate(e,t,r,n,o,a){return this._styleExpression.evaluate(e,t,r,n,o,a)}}class dr{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!er(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,o,a)}evaluate(e,t,r,n,o,a){return this._styleExpression.evaluate(e,t,r,n,o,a)}interpolationFactor(e,t,r){return this.interpolationType?Te.interpolationFactor(this.interpolationType,e,t,r):0}}function yr(e,t){const r=cr(e,t);if("error"===r.result)return r;const n=r.value.expression,o=Qt(n);if(!o&&!or(t))return nr([new l("","data expressions not supported")]);const a=tr(n,["zoom"]);if(!a&&!ar(t))return nr([new l("","zoom expressions not supported")]);const i=mr(n);if(!i&&!a)return nr([new l("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(i instanceof l)return nr([i]);if(i instanceof Te&&!ir(t))return nr([new l("",'"interpolate" expressions cannot be used with this property')]);if(!i)return rr(new fr(o?"constant":"source",r.value));const s=i instanceof Te?i.interpolation:void 0;return rr(new dr(o?"camera":"composite",r.value,i.labels,s))}function mr(e){let t=null;if(e instanceof we)t=mr(e.result);else if(e instanceof Fe){for(const r of e.args)if(t=mr(r),t)break}else(e instanceof Ee||e instanceof Te)&&e.input instanceof Bt&&"zoom"===e.input.name&&(t=e);return t instanceof l||e.eachChild((e=>{const r=mr(e);r instanceof l?t=r:!t&&r?t=new l("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new l("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function hr(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!hr(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const gr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function vr(e,t){return e<t?-1:e>t?1:0}function br(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(br(e[t]))return!0;return!1}function xr(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?wr(e[1],e[2],"=="):"!="===t?$r(wr(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?wr(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(xr))):"all"===t?["all"].concat(e.slice(1).map(xr)):"none"===t?["all"].concat(e.slice(1).map(xr).map($r)):"in"===t?kr(e[1],e.slice(2)):"!in"===t?$r(kr(e[1],e.slice(2))):"has"===t?Sr(e[1]):"!has"!==t||$r(Sr(e[1]));var r}function wr(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function kr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(vr)]]:["filter-in-small",e,["literal",t]]}}function Sr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function $r(e){return["!",e]}function zr(e){return"object"==typeof e?["literal",e]:e}function Ar(e){switch(e.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function Mr(e,t){const r=zr((n=e.default,o=t.default,void 0!==n?n:void 0!==o?o:void 0));var n,o;return void 0===r&&"resolvedImage"===t.type?"":r}function _r(e,t,r){const n=qr(e,t),o=["get",e.property];if("categorical"===n&&"boolean"==typeof r[0][0]){const n=["case"];for(const e of r)n.push(["==",o,e[0]],e[1]);return n.push(Mr(e,t)),n}if("categorical"===n){const n=["match",o];for(const e of r)Er(n,e[0],e[1],!1);return n.push(Mr(e,t)),n}if("interval"===n){const t=["step",["number",o]];for(const e of r)Er(t,e[0],e[1],!0);return jr(t),void 0===e.default?t:["case",["==",["typeof",o],"number"],t,zr(e.default)]}if("exponential"===n){const t=void 0!==e.base?e.base:1,n=[Ar(e),1===t?["linear"]:["exponential",t],["number",o]];for(const e of r)Er(n,e[0],e[1],!1);return void 0===e.default?n:["case",["==",["typeof",o],"number"],n,zr(e.default)]}throw new Error(`Unknown property function type ${n}`)}function jr(e){"step"===e[0]&&3===e.length&&(e.push(0),e.push(e[3]))}function Er(e,t,r,n){e.length>3&&t===e[e.length-2]||(n&&2===e.length||e.push(t),e.push(r))}function qr(e,t){return e.type?e.type:t.expression.interpolated?"exponential":"interval"}function Cr(e){const t=["concat"],r=/{([^{}]+)}/g;let n=0;for(let o=r.exec(e);null!==o;o=r.exec(e)){const a=e.slice(n,r.lastIndex-o[0].length);n=r.lastIndex,a.length>0&&t.push(a),t.push(["get",o[1]])}if(1===t.length)return e;if(n<e.length)t.push(e.slice(n));else if(2===t.length)return["to-string",t[1]];return t}function Nr(e){const t=e.key,r=e.value;return r?[new i(t,r,"constants have been deprecated as of v8")]:[]}function Ir(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Pr(e){if(Array.isArray(e))return e.map(Pr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Pr(e[r]);return t}return Ir(e)}function Tr(e){const t=e.key,r=e.value,n=e.valueSpec||{},o=e.objectElementValidators||{},a=e.style,s=e.styleSpec,l=e.validateSpec;let u=[];const p=sr(r);if("object"!==p)return[new i(t,r,`object expected, ${p} found`)];for(const e in r){const p=e.split(".")[0],c=n[p]||n["*"];let f;if(o[p])f=o[p];else if(n[p])f=l;else if(o["*"])f=o["*"];else{if(!n["*"]){u.push(new i(t,r[e],`unknown property "${e}"`));continue}f=l}u=u.concat(f({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:c,style:a,styleSpec:s,object:r,objectKey:e,validateSpec:l},r))}for(const e in n)o[e]||n[e].required&&void 0===n[e].default&&void 0===r[e]&&u.push(new i(t,r,`missing required property "${e}"`));return u}function Or(e){const t=e.value,r=e.valueSpec,n=e.validateSpec,o=e.style,a=e.styleSpec,s=e.key,l=e.arrayElementValidator||n;if("array"!==sr(t))return[new i(s,t,`array expected, ${sr(t)} found`)];if(r.length&&t.length!==r.length)return[new i(s,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new i(s,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let u={type:r.value,values:r.values};a.$version<7&&(u.function=r.function),"object"===sr(r.value)&&(u=r.value);let p=[];for(let r=0;r<t.length;r++)p=p.concat(l({array:t,arrayIndex:r,value:t[r],valueSpec:u,validateSpec:e.validateSpec,style:o,styleSpec:a,key:`${s}[${r}]`}));return p}function Fr(e){const t=e.key,r=e.value,n=e.valueSpec;let o=sr(r);return"number"===o&&r!=r&&(o="NaN"),"number"!==o?[new i(t,r,`number expected, ${o} found`)]:"minimum"in n&&r<n.minimum?[new i(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new i(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Rr(e){const t=e.valueSpec,r=Ir(e.value.type);let n,o,a,s={};const l="categorical"!==r&&void 0===e.value.property,u=!l,p="array"===sr(e.value.stops)&&"array"===sr(e.value.stops[0])&&"object"===sr(e.value.stops[0][0]),c=Tr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new i(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Or({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:f})),"array"===sr(n)&&0===n.length&&t.push(new i(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&l&&c.push(new i(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||c.push(new i(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!ir(e.valueSpec)&&c.push(new i(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(u&&!or(e.valueSpec)?c.push(new i(e.key,e.value,"property functions not supported")):l&&!ar(e.valueSpec)&&c.push(new i(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!p||void 0!==e.value.property||c.push(new i(e.key,e.value,'"property" property is required')),c;function f(e){let r=[];const n=e.value,l=e.key;if("array"!==sr(n))return[new i(l,n,`array expected, ${sr(n)} found`)];if(2!==n.length)return[new i(l,n,`array length 2 expected, length ${n.length} found`)];if(p){if("object"!==sr(n[0]))return[new i(l,n,`object expected, ${sr(n[0])} found`)];if(void 0===n[0].zoom)return[new i(l,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new i(l,n,"object stop key must have value")];if(a&&a>Ir(n[0].zoom))return[new i(l,n[0].zoom,"stop zoom values must appear in ascending order")];Ir(n[0].zoom)!==a&&(a=Ir(n[0].zoom),o=void 0,s={}),r=r.concat(Tr({key:`${l}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Fr,value:d}}))}else r=r.concat(d({key:`${l}[0]`,value:n[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return pr(Pr(n[1]))?r.concat([new i(`${l}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${l}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,a){const l=sr(e.value),u=Ir(e.value),p=null!==e.value?e.value:a;if(n){if(l!==n)return[new i(e.key,p,`${l} stop domain type must match previous stop domain type ${n}`)]}else n=l;if("number"!==l&&"string"!==l&&"boolean"!==l)return[new i(e.key,p,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==r){let n=`number expected, ${l} found`;return or(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i(e.key,p,n)]}return"categorical"!==r||"number"!==l||isFinite(u)&&Math.floor(u)===u?"categorical"!==r&&"number"===l&&void 0!==o&&u<o?[new i(e.key,p,"stop domain values must appear in ascending order")]:(o=u,"categorical"===r&&u in s?[new i(e.key,p,"stop domain values must be unique")]:(s[u]=!0,[])):[new i(e.key,p,`integer expected, found ${u}`)]}}function Lr(e){const t=("property"===e.expressionContext?yr:cr)(Pr(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new i(`${e.key}${t.key}`,e.value,t.message)));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new i(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!er(r))return[new i(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!er(r))return[new i(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!tr(r,["zoom","feature-state"]))return[new i(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Qt(r))return[new i(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Dr(e){const t=e.key,r=e.value,n=e.valueSpec,o=[];return Array.isArray(n.values)?-1===n.values.indexOf(Ir(r))&&o.push(new i(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(Ir(r))&&o.push(new i(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),o}function Ur(e){return hr(Pr(e.value))?Lr(s({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Vr(e)}function Vr(e){const t=e.value,r=e.key;if("array"!==sr(t))return[new i(r,t,`array expected, ${sr(t)} found`)];const n=e.styleSpec;let o,a=[];if(t.length<1)return[new i(r,t,"filter array must have at least 1 element")];switch(a=a.concat(Dr({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ir(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Ir(t[1])&&a.push(new i(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&a.push(new i(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(o=sr(t[1]),"string"!==o&&a.push(new i(`${r}[1]`,t[1],`string expected, ${o} found`)));for(let s=2;s<t.length;s++)o=sr(t[s]),"$type"===Ir(t[1])?a=a.concat(Dr({key:`${r}[${s}]`,value:t[s],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&a.push(new i(`${r}[${s}]`,t[s],`string, number, or boolean expected, ${o} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)a=a.concat(Vr({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":o=sr(t[1]),2!==t.length?a.push(new i(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==o&&a.push(new i(`${r}[1]`,t[1],`string expected, ${o} found`))}return a}function Gr(e,t){const r=e.key,n=e.validateSpec,o=e.style,a=e.styleSpec,s=e.value,l=e.objectKey,u=a[`${t}_${e.layerType}`];if(!u)return[];const p=l.match(/^(.*)-transition$/);if("paint"===t&&p&&u[p[1]]&&u[p[1]].transition)return n({key:r,value:s,valueSpec:a.transition,style:o,styleSpec:a});const c=e.valueSpec||u[l];if(!c)return[new i(r,s,`unknown property "${l}"`)];let f;if("string"===sr(s)&&or(c)&&!c.tokens&&(f=/^{([^}]+)}$/.exec(s)))return[new i(r,s,`"${l}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(f[1])} }\`.`)];const d=[];return"symbol"===e.layerType&&("text-field"===l&&o&&!o.glyphs&&d.push(new i(r,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&lr(Pr(s))&&"identity"===Ir(s.type)&&d.push(new i(r,s,'"text-font" does not support identity functions'))),d.concat(n({key:e.key,value:s,valueSpec:c,style:o,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:l}))}function Jr(e){return Gr(e,"paint")}function Wr(e){return Gr(e,"layout")}function Br(e){let t=[];const r=e.value,n=e.key,o=e.style,a=e.styleSpec;r.type||r.ref||t.push(new i(n,r,'either "type" or "ref" is required'));let l=Ir(r.type);const u=Ir(r.ref);if(r.id){const a=Ir(r.id);for(let s=0;s<e.arrayIndex;s++){const e=o.layers[s];Ir(e.id)===a&&t.push(new i(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new i(n,r[e],`"${e}" is prohibited for ref layers`))})),o.layers.forEach((t=>{Ir(t.id)===u&&(e=t)})),e?e.ref?t.push(new i(n,r.ref,"ref cannot reference another ref layer")):l=Ir(e.type):t.push(new i(n,r.ref,`ref layer "${u}" not found`))}else if("background"!==l)if(r.source){const e=o.sources&&o.sources[r.source],a=e&&Ir(e.type);e?"vector"===a&&"raster"===l?t.push(new i(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===l?t.push(new i(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==l?t.push(new i(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==a||r["source-layer"]?"raster-dem"===a&&"hillshade"!==l?t.push(new i(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==l||!r.paint||!r.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new i(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new i(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new i(n,r.source,`source "${r.source}" not found`))}else t.push(new i(n,r,'missing required property "source"'));return t=t.concat(Tr({key:n,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:Ur,layout:e=>Tr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Wr(s({layerType:l},e))}}),paint:e=>Tr({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Jr(s({layerType:l},e))}})}})),t}function Xr(e){const t=e.value,r=e.key,n=sr(t);return"string"!==n?[new i(r,t,`string expected, ${n} found`)]:[]}const Zr={promoteId:function({key:e,value:t}){if("string"===sr(t))return Xr({key:e,value:t});{const r=[];for(const n in t)r.push(...Xr({key:`${e}.${n}`,value:t[n]}));return r}}};function Yr(e){const t=e.value,r=e.key,n=e.styleSpec,o=e.style,a=e.validateSpec;if(!t.type)return[new i(r,t,'"type" is required')];const s=Ir(t.type);let l;switch(s){case"vector":case"raster":return l=Tr({key:r,value:t,valueSpec:n[`source_${s.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:Zr,validateSpec:a}),l;case"raster-dem":return l=function(e){var t;const r=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,o=e.styleSpec,a=o.source_raster_dem,s=e.style;let l=[];const u=sr(n);if(void 0===n)return l;if("object"!==u)return l.push(new i("source_raster_dem",n,`object expected, ${u} found`)),l;const p="custom"===Ir(n.encoding),c=["redFactor","greenFactor","blueFactor","baseShift"],f=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const t in n)!p&&c.includes(t)?l.push(new i(t,n[t],`In "${r}": "${t}" is only valid when "encoding" is set to "custom". ${f} encoding found`)):a[t]?l=l.concat(e.validateSpec({key:t,value:n[t],valueSpec:a[t],validateSpec:e.validateSpec,style:s,styleSpec:o})):l.push(new i(t,n[t],`unknown property "${t}"`));return l}({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:a}),l;case"geojson":if(l=Tr({key:r,value:t,valueSpec:n.source_geojson,style:o,styleSpec:n,validateSpec:a,objectElementValidators:Zr}),t.cluster)for(const e in t.clusterProperties){const[n,o]=t.clusterProperties[e],i="string"==typeof n?[n,["accumulated"],["get",e]]:n;l.push(...Lr({key:`${r}.${e}.map`,value:o,validateSpec:a,expressionContext:"cluster-map"})),l.push(...Lr({key:`${r}.${e}.reduce`,value:i,validateSpec:a,expressionContext:"cluster-reduce"}))}return l;case"video":return Tr({key:r,value:t,valueSpec:n.source_video,style:o,validateSpec:a,styleSpec:n});case"image":return Tr({key:r,value:t,valueSpec:n.source_image,style:o,validateSpec:a,styleSpec:n});case"canvas":return[new i(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Dr({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:o,validateSpec:a,styleSpec:n})}}function Kr(e){const t=e.value,r=e.styleSpec,n=r.light,o=e.style;let a=[];const s=sr(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new i("light",t,`object expected, ${s} found`)]),a;for(const s in t){const l=s.match(/^(.*)-transition$/);a=l&&n[l[1]]&&n[l[1]].transition?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:o,styleSpec:r})):n[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:o,styleSpec:r})):a.concat([new i(s,t[s],`unknown property "${s}"`)])}return a}function Hr(e){const t=e.value,r=e.styleSpec,n=r.sky,o=e.style,a=sr(t);if(void 0===t)return[];if("object"!==a)return[new i("sky",t,`object expected, ${a} found`)];let s=[];for(const a in t)s=n[a]?s.concat(e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:o,styleSpec:r})):s.concat([new i(a,t[a],`unknown property "${a}"`)]);return s}function Qr(e){const t=e.value,r=e.styleSpec,n=r.terrain,o=e.style;let a=[];const s=sr(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new i("terrain",t,`object expected, ${s} found`)]),a;for(const s in t)a=n[s]?a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:o,styleSpec:r})):a.concat([new i(s,t[s],`unknown property "${s}"`)]);return a}function en(e){let t=[];const r=e.value,n=e.key;if(Array.isArray(r)){const o=[],a=[];for(const s in r){r[s].id&&o.includes(r[s].id)&&t.push(new i(n,r,`all the sprites' ids must be unique, but ${r[s].id} is duplicated`)),o.push(r[s].id),r[s].url&&a.includes(r[s].url)&&t.push(new i(n,r,`all the sprites' URLs must be unique, but ${r[s].url} is duplicated`)),a.push(r[s].url);const l={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(Tr({key:`${n}[${s}]`,value:r[s],valueSpec:l,validateSpec:e.validateSpec}))}return t}return Xr({key:n,value:r})}const tn={"*":()=>[],array:Or,boolean:function(e){const t=e.value,r=e.key,n=sr(t);return"boolean"!==n?[new i(r,t,`boolean expected, ${n} found`)]:[]},number:Fr,color:function(e){const t=e.key,r=e.value,n=sr(r);return"string"!==n?[new i(t,r,`color expected, ${n} found`)]:H.parse(String(r))?[]:[new i(t,r,`color expected, "${r}" found`)]},constants:Nr,enum:Dr,filter:Ur,function:Rr,layer:Br,object:Tr,source:Yr,light:Kr,sky:Hr,terrain:Qr,projection:function(e){const t=e.value,r=e.styleSpec,n=r.projection,o=e.style,a=sr(t);if(void 0===t)return[];if("object"!==a)return[new i("projection",t,`object expected, ${a} found`)];let s=[];for(const a in t)s=n[a]?s.concat(e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:o,styleSpec:r})):s.concat([new i(a,t[a],`unknown property "${a}"`)]);return s},projectionDefinition:function(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const n=sr(r);return"array"!==n||function(e){return Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]}(r)||function(e){return!!["interpolate","step","literal"].includes(e[0])}(r)?["array","string"].includes(n)?[]:[new i(t,r,`projection expected, invalid type "${n}" found`)]:[new i(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Xr,formatted:function(e){return 0===Xr(e).length?[]:Lr(e)},resolvedImage:function(e){return 0===Xr(e).length?[]:Lr(e)},padding:function(e){const t=e.key,r=e.value;if("array"===sr(r)){if(r.length<1||r.length>4)return[new i(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const n={type:"number"};let o=[];for(let a=0;a<r.length;a++)o=o.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:n}));return o}return Fr({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(e){const t=e.key,r=e.value,n=sr(r),o=e.styleSpec;if("array"!==n||r.length<1||r.length%2!=0)return[new i(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let n=0;n<r.length;n+=2)a=a.concat(Dr({key:`${t}[${n}]`,value:r[n],valueSpec:o.layout_symbol["text-anchor"]})),a=a.concat(Or({key:`${t}[${n+1}]`,value:r[n+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:o}));return a},sprite:en};function rn(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=rn,r.expression&&lr(Ir(t))?Rr(e):r.expression&&pr(Pr(t))?Lr(e):r.type&&tn[r.type]?tn[r.type](e):Tr(s({},e,{valueSpec:r.type?n[r.type]:r}))}function nn(e){const t=e.value,r=e.key,n=Xr(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new i(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new i(r,t,'"glyphs" url must include a "{range}" token'))),n}function on(e,t=n){let r=[];return r=r.concat(rn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:rn,objectElementValidators:{glyphs:nn,"*":()=>[]}})),e.constants&&(r=r.concat(Nr({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:rn}))),sn(r)}function an(e){return function(t){return e({...t,validateSpec:rn})}}function sn(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function ln(e){return function(...t){return sn(e.apply(this,t))}}on.source=ln(an(Yr)),on.sprite=ln(an(en)),on.glyphs=ln(an(nn)),on.light=ln(an(Kr)),on.sky=ln(an(Hr)),on.terrain=ln(an(Qr)),on.layer=ln(an(Br)),on.filter=ln(an(Ur)),on.paintProperty=ln(an(Jr)),on.layoutProperty=ln(an(Wr));const un=n;var pn={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},cn=" ",fn=/(italic|oblique)$/i,dn={};function yn(e,t,r){var n=dn[e];if(!n){Array.isArray(e)||(e=[e]);for(var o,a,i=400,s="normal",l=[],u=0,p=e.length;u<p;++u){var c=e[u].split(" "),f=c[c.length-1].toLowerCase();for(var d in"normal"==f||"italic"==f||"oblique"==f?(s=a?s:f,a=!0,c.pop(),f=c[c.length-1].toLowerCase()):fn.test(f)&&(f=f.replace(fn,""),s=a?s:c[c.length-1].replace(f,""),a=!0),pn){var y=c.length>1?c[c.length-2].toLowerCase():"";if(f==d||f==d.replace("-","")||y+"-"+f==d){i=o?i:pn[d],c.pop(),y&&d.startsWith(y)&&c.pop();break}}o||"number"!=typeof f||(i=f,o=!0);var m=c.join(cn).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");-1!==m.indexOf(cn)&&(m='"'+m+'"'),l.push(m)}n=dn[e]=[s,i,l]}return n[0]+cn+n[1]+cn+t+"px"+(r?"/"+r:"")+cn+n[2]}var mn=r(6679),hn=r(6933),gn=r(915),vn=r(4238),bn=r(4778),xn=r(7733),wn=r(3628),kn=r(9700),Sn=r(953),$n=r(9276),zn=r(1426),An=r(8774),Mn=r(8756),_n=r(1078),jn=r(4087);const En="https://api.mapbox.com";function qn(e){return 0!==e.indexOf("mapbox://")?"":e.slice(9)}function Cn(e,t,r){const n=qn(e);if(!n)return decodeURI(new URL(e,r).href);if(0!==n.indexOf("sprites/"))throw new Error(`unexpected sprites url: ${e}`);const o=n.slice(8);return`${En}/styles/v1/${o}/sprite?access_token=${t}`}function Nn(e,t){const r=qn(e);if(!r)return decodeURI(new URL(e,location.href).href);if(0!==r.indexOf("styles/"))throw new Error(`unexpected style url: ${e}`);const n=r.slice(7);return`${En}/styles/v1/${n}?&access_token=${t}`}const In=["a","b","c","d"];function Pn(e,t,r,n){const o=new URL(e,n||location.href),a=qn(e);if(!a)return t?(o.searchParams.has(r)||o.searchParams.set(r,t),[decodeURI(o.href)]):[decodeURI(o.href)];if("mapbox.satellite"===a){const e=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${a}/{z}/{x}/{y}${e}.webp?access_token=${t}`]}return In.map((e=>`https://${e}.tiles.mapbox.com/v4/${a}/{z}/{x}/{y}.vector.pbf?access_token=${t}`))}const Tn=Object.freeze({}),On={},Fn={};let Rn=0;function Ln(e){return e.id||(e.id=Rn++),e.id}function Dn(e){return e*Math.PI/180}const Un=function(){const e=[];for(let t=78271.51696402048;e.length<=24;t/=2)e.push(t);return e}();function Vn(e,t){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(e,t);const r=document.createElement("canvas");return r.width=e,r.height=t,r}function Gn(e,t){let r=0;const n=t.length;for(;r<n;++r)if(t[r]<e&&r+1<n){const n=t[r]/t[r+1];return r+Math.log(t[r]/e)/Math.log(n)}return n-1}const Jn={};function Wn(e,t,r={},n){if(t in Jn)return n&&(n.url=Jn[t][0].url),Jn[t][1];const o=r.transformRequest&&r.transformRequest(t,e)||t,a=function(e){return delete Jn[t],Promise.reject(new Error("Error fetching source "+t))},i=function(e){return delete Jn[t],e.ok?e.json():Promise.reject(new Error("Error fetching source "+t))},s=(0,vn.hq)((()=>o)).then((e=>e instanceof Response?(n&&(n.url=e.url),i(e)):(e instanceof Request||(e=new Request(e)),e.headers.get("Accept")||e.headers.set("Accept","application/json"),n&&(n.url=e.url),fetch(e).then(i).catch(a)))).catch(a);return Jn[t]=[o,s],s}function Bn(e,t){if("string"!=typeof e)return Promise.resolve(e);if(!e.trim().startsWith("{"))return Wn("Style",e=Nn(e,t.accessToken),t);try{const t=JSON.parse(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}const Xn={};function Zn(e,t,r,n){const o=[2*r*t.pixelRatio+t.width,2*r*t.pixelRatio+t.height],a=Vn(o[0],o[1]),i=a.getContext("2d");i.drawImage(e,t.x,t.y,t.width,t.height,r*t.pixelRatio,r*t.pixelRatio,t.width,t.height);const s=i.getImageData(0,0,o[0],o[1]);i.globalCompositeOperation="destination-over",i.fillStyle=`rgba(${255*n.r},${255*n.g},${255*n.b},${n.a})`;const l=s.data;for(let e=0,n=s.width;e<n;++e)for(let o=0,a=s.height;o<a;++o)l[4*(o*n+e)+3]>0&&i.arc(e,o,r*t.pixelRatio,0,2*Math.PI);return i.fill(),a}function Yn(e,t,r){const n=Math.max(0,Math.min(1,(r-e)/(t-e)));return n*n*(3-2*n)}function Kn(e,t,r){const n=Vn(t.width,t.height),o=n.getContext("2d");o.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height);const a=o.getImageData(0,0,t.width,t.height),i=a.data;for(let e=0,t=a.width;e<t;++e)for(let n=0,o=a.height;n<o;++n){const o=4*(n*t+e),a=.75,s=.1,l=Yn(a-s,a+s,i[o+3]/255);l>0?(i[o+0]=Math.round(255*r.r*l),i[o+1]=Math.round(255*r.g*l),i[o+2]=Math.round(255*r.b*l),i[o+3]=Math.round(255*l)):i[o+3]=0}return o.putImageData(a,0,0),n}const Hn=Array(256).join("");function Qn(e,t){if(t>=.05){let r="";const n=e.split("\n"),o=Hn.slice(0,Math.round(t/.1));for(let e=0,t=n.length;e<t;++e)e>0&&(r+="\n"),r+=n[e].split("").join(o);return r}return e}let eo;function to(){return eo||(eo=Vn(1,1).getContext("2d")),eo}function ro(e,t){return to().measureText(e).width+(e.length-1)*t}const no={};function oo(e,t,r,n){if(-1!==e.indexOf("\n")){const o=e.split("\n"),a=[];for(let e=0,i=o.length;e<i;++e)a.push(oo(o[e],t,r,n));return a.join("\n")}const o=r+","+t+","+e+","+n;let a=no[o];if(!a){const i=e.split(" ");if(i.length>1){const e=to();e.font=t;const o=e.measureText("M").width*r;let s="";const l=[];for(let e=0,t=i.length;e<t;++e){const t=i[e],r=s+(s?" ":"")+t;ro(r,n)<=o?s=r:(s&&l.push(s),s=t)}s&&l.push(s);for(let e=0,t=l.length;e<t&&t>1;++e){const r=l[e];if(ro(r,n)<.35*o){const o=e>0?ro(l[e-1],n):1/0,a=e<t-1?ro(l[e+1],n):1/0;l.splice(e,1),t-=1,o<a?(l[e-1]+=" "+r,e-=1):l[e]=r+" "+l[e]}}for(let e=0,t=l.length-1;e<t;++e){const r=l[e],a=l[e+1];if(ro(r,n)>.7*o&&ro(a,n)<.6*o){const i=r.split(" "),s=i.pop();ro(s,n)<.2*o&&(l[e]=i.join(" "),l[e+1]=s+" "+a),t-=1}}a=l.join("\n")}else a=e;a=Qn(a,n),no[o]=a}return a}An.yY.on("propertychange",(()=>{for(const e in no)delete no[e]}));const ao=["Arial","Courier New","Times New Roman","Verdana","sans-serif","serif","monospace","cursive","fantasy"],io={},so={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},lo={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},uo={zoom:0,distanceFromCenter:0};let po,co;function fo(e,t,r,n,o,a){const i=e.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[i]||(o[i]={});const s=o[i];if(!s[r]){let n=(e[t]||Tn)[r];const o=un[`${t}_${e.type}`][r];void 0===n&&(n=o.default);let a=pr(n);if(!a&&lr(n)&&(n=function(e,t){let r=e.stops;if(!r)return function(e,t){const r=["get",e.property];if(void 0===e.default)return"string"===t.type?["string",r]:r;if("enum"===t.type)return["match",r,Object.keys(t.values),r,e.default];{const n=["color"===t.type?"to-color":t.type,r,zr(e.default)];return"array"===t.type&&n.splice(1,0,t.value,t.length||null),n}}(e,t);const n=r&&"object"==typeof r[0][0],o=n||void 0!==e.property,a=n||!o;return r=r.map((e=>!o&&t.tokens&&"string"==typeof e[1]?[e[0],Cr(e[1])]:[e[0],zr(e[1])])),n?function(e,t,r){const n={},o={},a=[];for(let t=0;t<r.length;t++){const i=r[t],s=i[0].zoom;void 0===n[s]&&(n[s]={zoom:s,type:e.type,property:e.property,default:e.default},o[s]=[],a.push(s)),o[s].push([i[0].value,i[1]])}if("exponential"===qr({},t)){const r=[Ar(e),["linear"],["zoom"]];for(const e of a)Er(r,e,_r(n[e],t,o[e]),!1);return r}{const e=["step",["zoom"]];for(const r of a)Er(e,r,_r(n[r],t,o[r]),!0);return jr(e),e}}(e,t,r):a?function(e,t,r,n=["zoom"]){const o=qr(e,t);let a,i=!1;if("interval"===o)a=["step",n],i=!0;else{if("exponential"!==o)throw new Error(`Unknown zoom function type "${o}"`);{const t=void 0!==e.base?e.base:1;a=[Ar(e),1===t?["linear"]:["exponential",t],n]}}for(const e of r)Er(a,e[0],e[1],i);return jr(a),a}(e,t,r):_r(e,t,r)}(n,o),a=!0),a){const e=function(e,t){const r=yr(e,t);if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return r.value}(n,o);s[r]=e.evaluate.bind(e)}else"color"==o.type&&(n=H.parse(n)),s[r]=function(){return n}}return s[r](uo,n,a)}function yo(e,t,r,n){return fo(e,"layout",`${r}-allow-overlap`,t,n)?fo(e,"layout",`${r}-ignore-placement`,t,n)?"none":"obstacle":"declutter"}function mo(e,t,r,n){if(n||console.warn("No filterCache provided to evaluateFilter()"),!(e in n))try{n[e]=function(e){if(null==e)return{filter:()=>!0,needGeometry:!1};hr(e)||(e=xr(e));const t=cr(e,gr);if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,r,n)=>t.value.evaluate(e,r,{},n),needGeometry:br(e)}}(t).filter}catch(t){console.warn("Filter will evaluate to false: "+t.message),n[e]=function(){return!1}}return n[e](uo,r)}Bt.register(Wt,{...Bt.definitions,pitch:[{kind:"number"},[],e=>uo.pitch||90],"distance-from-center":[{kind:"number"},[],e=>uo.distanceFromCenter||0]});function ho(e,t){if(e){if(0===e.a||0===t)return;const r=e.a;return t=void 0===t?1:t,0===r?"transparent":"rgba("+Math.round(255*e.r/r)+","+Math.round(255*e.g/r)+","+Math.round(255*e.b/r)+","+r*t+")"}return e}const go=/\{[^{}}]*\}/g;function vo(e,t){return e.replace(go,(function(e){return t[e.slice(1,-1)]||""}))}function bo(e,t){let r=e.split(":")[0];return r===e&&(r="default"),t[r]}const xo={};var wo=r(1365),ko=r(4662),So=r(5598),$o=r(764),zo=r(2757),Ao=r(8063),Mo=r(942),_o=r(8100),jo=r(6391),Eo=r(6444),qo=r(4218),Co=r(4602),No=r(5923),Io=r(6758),Po=r(4863);function To(e,t=512){return e.getExtent()?(0,Po.EN)({extent:e.getExtent(),tileSize:t,maxZoom:22}).getResolutions():Un}function Oo(e,t,r="",n={},o=void 0){let i,s,l,u,p=!0;return"string"==typeof r||Array.isArray(r)?u=r:(l=r,u=l.source||l.layers,n=l),"string"==typeof n?(i=n,l={}):(i=n.styleUrl,l=n),!1===l.updateSource&&(p=!1),o||(o=l.resolutions),i||"string"!=typeof t||t.trim().startsWith("{")||(i=t),i&&(i=i.startsWith("data:")?location.href:Nn(i,l.accessToken),l=function(e,t){return t.accessToken||(t=Object.assign({},t),new URL(e).searchParams.forEach(((e,r)=>{t.accessToken=e,t.accessTokenParam=r}))),t}(i,l)),new Promise((function(r,n){Bn(t,l).then((function(t){if(8!=t.version)return n(new Error("glStyle version 8 required."));if(!(e instanceof zo.A||e instanceof Ao.A))return n(new Error("Can only apply to VectorLayer or VectorTileLayer"));const c=e instanceof Ao.A?"vector":"geojson";if(u?s=Array.isArray(u)?t.layers.find((function(e){return e.id===u[0]})).source:u:(s=t.layers.find((function(e){return e.source&&t.sources[e.source].type===c})).source,u=s),!s)return n(new Error(`No ${c} source found in the glStyle.`));function f(){if(!p)return Promise.resolve();if(e instanceof Ao.A)return function(e,t,r){return new Promise((function(n,o){(function(e,t,r={}){const n=[t,JSON.stringify(e)].toString();let o=Xn[n];if(!o||r.transformRequest){let a;r.transformRequest&&(a=(e,t)=>{const n=r.transformRequest&&r.transformRequest(t,"Tiles")||t;if(e instanceof Mn.A)e.setLoader(((t,r,o)=>{const a=function(r){r.arrayBuffer().then((r=>{const n=e.getFormat().readFeatures(r,{extent:t,featureProjection:o});e.setFeatures(n)}))};(0,vn.hq)((()=>n)).then((t=>{if(t instanceof Response)return a(t);fetch(t).then(a).catch((t=>e.setState(_n.A.ERROR)))})).catch((t=>e.setState(_n.A.ERROR)))}));else{const t=e.getImage();(0,vn.hq)((()=>n)).then((r=>{if("string"==typeof r)return void(t.src=r);const n=e=>e.blob().then((e=>{const r=URL.createObjectURL(e);t.addEventListener("load",(()=>URL.revokeObjectURL(r))),t.addEventListener("error",(()=>URL.revokeObjectURL(r))),t.src=r}));if(r instanceof Response)return n(r);fetch(r).then(n).catch((t=>e.setState(_n.A.ERROR)))})).catch((t=>e.setState(_n.A.ERROR)))}});const i=e.url;if(i&&!e.tiles){const n=Pn(i,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(i.startsWith("mapbox://"))o=Promise.resolve({tileJson:Object.assign({},e,{url:void 0,tiles:n}),tileLoadFunction:a});else{const e={};o=Wn("Source",n[0],r,e).then((function(t){return t.tiles=t.tiles.map((function(n){return"tms"===t.scheme&&(n=n.replace("{y}","{-y}")),Pn(n,r.accessToken,r.accessTokenParam||"access_token",e.url)[0]})),Promise.resolve({tileJson:t,tileLoadFunction:a})}))}}else e.tiles?(e=Object.assign({},e,{tiles:e.tiles.map((function(n){return"tms"===e.scheme&&(n=n.replace("{y}","{-y}")),Pn(n,r.accessToken,r.accessTokenParam||"access_token",t||location.href)[0]}))}),o=Promise.resolve({tileJson:Object.assign({},e),tileLoadFunction:a})):o=Promise.reject(new Error("source has no `tiles` nor `url`"));Xn[n]=o}return o})(e,t,r).then((function({tileJson:t,tileLoadFunction:o}){const a=function(e,t,r){const n=new qo.A({tileJSON:t,tileSize:e.tileSize||t.tileSize||512}),o=n.getTileJSON(),a=n.getTileGrid(),i=(0,jo.Jt)(r.projection||"EPSG:3857"),s=function(e,t){const r=e.bounds;if(r){const e=(0,jo.Rb)([r[0],r[1]],t),n=(0,jo.Rb)([r[2],r[3]],t);return[e[0],e[1],n[0],n[1]]}return(0,jo.Jt)(t).getExtent()}(o,i),l=i.getExtent(),u=o.minzoom||0,p=o.maxzoom||22,c={attributions:n.getAttributions(),projection:i,tileGrid:new Io.A({origin:l?(0,gn.Py)(l):a.getOrigin(0),extent:s||a.getExtent(),minZoom:u,resolutions:To(i,t.tileSize).slice(0,p+1),tileSize:a.getTileSize(0)})};return Array.isArray(o.tiles)?c.urls=o.tiles:c.url=o.tiles,c}(e,t,r);a.tileLoadFunction=o,a.format=new ko.A({layerName:"mvt:layer"});const i=new No.A(a);i.set("mapbox-source",e),n(i)})).catch(o)}))}(t.sources[s],i,l).then((function(t){const r=e.getSource();r?t!==r&&(r.setTileUrlFunction(t.getTileUrlFunction()),"function"==typeof r.setUrls&&"function"==typeof t.getUrls&&r.setUrls(t.getUrls()),r.format_||(r.format_=t.format_),r.getAttributions()||r.setAttributions(t.getAttributions()),r.getTileLoadFunction()===No.Y&&r.setTileLoadFunction(t.getTileLoadFunction()),(0,jo.tI)(r.getProjection(),t.getProjection())&&(r.tileGrid=t.getTileGrid())):e.setSource(t);const n=e.getSource().getTileGrid();!isFinite(e.getMaxResolution())&&!isFinite(e.getMinZoom())&&n.getMinZoom()>0&&e.setMaxResolution(function(e,t){const r=Math.floor(e),n=Math.pow(2,e-r);return t[r]/n}(Math.max(0,n.getMinZoom()-1e-12),n.getResolutions()))}));const r=t.sources[s];let n=e.getSource();n&&n.get("mapbox-source")===r||(n=function(e,t,r){const n=r.projection?new wo.A({dataProjection:r.projection}):new wo.A,o=e.data,a={};if("string"==typeof o){const[a]=Pn(o,r.accessToken,r.accessTokenParam||"access_token",t||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(a)){const t=(e,t,r)=>{const n=function(e){return`{bbox-${(e?e.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}(r);return a.replace(n,`${e.join(",")}`)},o=new Co.A({attributions:e.attribution,format:n,loader:(e,n,a,i,s)=>{Wn("GeoJSON","function"==typeof t?t(e,n,a):t,r).then((e=>{const t=o.getFormat().readFeatures(e,{featureProjection:a});o.addFeatures(t),i(t)})).catch((t=>{o.removeLoadedExtent(e),s()}))},strategy:Mo.Qk});return o.set("mapbox-source",e),o}const i=new Co.A({attributions:e.attribution,format:n,url:a,loader:(e,t,n,o,s)=>{Wn("GeoJSON",a,r).then((e=>{const t=i.getFormat().readFeatures(e,{featureProjection:n});i.addFeatures(t),o(t)})).catch((t=>{i.removeLoadedExtent(e),s()}))}});return i}a.features=n.readFeatures(o,{featureProjection:(0,jo.Tf)()||"EPSG:3857"});const i=new Co.A(Object.assign({attributions:e.attribution,format:n},a));return i.set("mapbox-source",e),i}(r,i,l));const o=e.getSource();return o?n!==o&&(o.getAttributions()||o.setAttributions(n.getAttributions()),o.format_||(o.format_=n.getFormat()),o.url_=n.getUrl()):e.setSource(n),Promise.resolve()}let d,y;const m={},h={};function g(){if(y||t.sprite&&!m)y?(e.setStyle(y),f().then(r).catch(n)):n(new Error("Something went wrong trying to apply style."));else{if(l.projection&&!o){const e=(0,jo.Jt)(l.projection).getUnits();"m"!==e&&(o=Un.map((t=>t/_o.I[e])))}let i;const p=e.getSource();p instanceof No.A&&p.format_ instanceof ko.A&&(i=p.format_.layerName_),y=function(e,t,r,n=Un,o,i,s,l){if("string"==typeof t&&(t=JSON.parse(t)),8!=t.version)throw new Error("glStyle version 8 required.");xo[function(e,t){return Ln(e)+"."+(0,jn.v6)(t)}(t,e)]=Array.from(arguments);const u={};("string"==typeof i||i instanceof Request||i instanceof Response||i instanceof Promise)&&(i={default:i});for(const t in i){const r=i[t];(0,vn.hq)((()=>r)).then((async r=>{let n;if("undefined"!=typeof Image){const o=new Image;if("string"==typeof r)o.crossOrigin="anonymous",o.src=r;else{let e;r instanceof Request?e=await fetch(r):r instanceof Response&&(e=r);const t=await e.blob();n=URL.createObjectURL(t),o.src=n}o.addEventListener("load",(function r(){o.removeEventListener("load",r),u[t]={image:o,size:[o.width,o.height]},e.changed(),n&&URL.revokeObjectURL(n)})),o.addEventListener("error",(function e(){URL.revokeObjectURL(n),o.removeEventListener("error",e)}))}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){const e=self;e.postMessage({action:"loadImage",src:r}),e.addEventListener("message",(function(e){"imageLoaded"===e.data.action&&e.data.src===r&&(u[t]={image:e.data.image,size:[e.data.image.width,e.data.image.height]})}))}}))}const p=function(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=a(e[r],t[e[r].ref]));return e}(t.layers),c={},f=[],d={},y={},m=function(e){let t=On[e.id];return t||(t={},On[Ln(e)]=t),t}(t),h=function(e){let t=Fn[e.id];return t||(t={},Fn[Ln(e)]=t),t}(t);let g;for(let e=0,n=p.length;e<n;++e){const n=p[e],o=n.id;if("string"==typeof r&&n.source==r||Array.isArray(r)&&-1!==r.indexOf(o)){const r=n["source-layer"];if(g){if(n.source!==g)throw new Error(`Layer "${o}" does not use source "${g}`)}else{g=n.source;const e=t.sources[g];if(!e)throw new Error(`Source "${g}" is not defined`);const r=e.type;if("vector"!==r&&"geojson"!==r)throw new Error(`Source "${g}" is not of type "vector" or "geojson", but "${r}"`)}let a=c[r];a||(a=[],c[r]=a),a.push({layer:n,index:e}),f.push(o)}}const v=new Sn.A,b=new wn.A,x=[],w=function(r,a,i){const p=e.getSource?.()?.format_?.layerName_??"mvt:layer",f=r.getProperties(),g=c[f[p]];if(!g)return;let w=n.indexOf(a);-1==w&&(w=Gn(a,n)),uo.zoom=w,uo.distanceFromCenter=0;const k=r.getGeometry(),S=so[k.getType()],$=e.get("map");if($&&$ instanceof mn.A&&1===S){const e=$.getSize();if(e){const t=$.getView().getCenter(),r=(0,gn.q1)(k.getExtent());uo.distanceFromCenter=(0,hn.Io)(t,r)/a/e[1]}}const z={id:r.getId(),properties:f,type:S},A=e.get("mapbox-featurestate")[r.getId()];let M,_=-1;for(let n=0,p=g.length;n<p;++n){const p=g[n],c=p.layer,k=c.id;if(void 0!==i&&i!==k)continue;const $=c.layout||Tn,j=c.paint||Tn;if("none"===$.visibility||"minzoom"in c&&w<c.minzoom||"maxzoom"in c&&w>=c.maxzoom)continue;const E=c.filter;if(!E||mo(k,E,z,h)){let n,i,h,g,w,k;M=c;const E=p.index;if(3==S&&("fill"==c.type||"fill-extrusion"==c.type))if(i=fo(c,"paint",c.type+"-opacity",z,m,A),c.type+"-pattern"in j){const e=fo(c,"paint",c.type+"-pattern",z,m,A);if(e){const t="string"==typeof e?vo(e,f):e.toString(),r=bo(t,u);if(o&&o[t]&&r){++_,k=x[_],k&&k.getFill()&&!k.getStroke()&&!k.getText()||(k=new $n.Ay({fill:new wn.A}),x[_]=k),h=k.getFill(),k.setZIndex(E);const e=t+"."+i;let n=y[e];if(!n){const a=o[t],s=Vn(a.width,a.height),l=s.getContext("2d");l.globalAlpha=i,l.drawImage(r.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),n=l.createPattern(s,"repeat"),y[e]=n}h.setColor(n)}}}else n=ho(fo(c,"paint",c.type+"-color",z,m,A),i),c.type+"-outline-color"in j&&(w=ho(fo(c,"paint",c.type+"-outline-color",z,m,A),i)),w||(w=n),(n||w)&&(++_,k=x[_],(!k||n&&!k.getFill()||!n&&k.getFill()||w&&!k.getStroke()||!w&&k.getStroke()||k.getText())&&(k=new $n.Ay({fill:n?new wn.A:void 0,stroke:w?new Sn.A:void 0}),x[_]=k),n&&(h=k.getFill(),h.setColor(n)),w&&(g=k.getStroke(),g.setColor(w),g.setWidth(.5)),k.setZIndex(E));if(1!=S&&"line"==c.type){n="line-pattern"in j?void 0:ho(fo(c,"paint","line-color",z,m,A),fo(c,"paint","line-opacity",z,m,A));const e=fo(c,"paint","line-width",z,m,A);n&&e>0&&(++_,k=x[_],k&&k.getStroke()&&!k.getFill()&&!k.getText()||(k=new $n.Ay({stroke:new Sn.A}),x[_]=k),g=k.getStroke(),g.setLineCap(fo(c,"layout","line-cap",z,m,A)),g.setLineJoin(fo(c,"layout","line-join",z,m,A)),g.setMiterLimit(fo(c,"layout","line-miter-limit",z,m,A)),g.setColor(n),g.setWidth(e),g.setLineDash(j["line-dasharray"]?fo(c,"paint","line-dasharray",z,m,A).map((function(t){return t*e})):null),k.setZIndex(E))}let q,C,N,I,P,T,O,F,R,L=!1,D=null,U=0;if((1==S||2==S)&&"icon-image"in $){const t=fo(c,"layout","icon-image",z,m,A);if(t){let n;q="string"==typeof t?vo(t,f):t.toString();const i=l?l(e,q):void 0,s=bo(q,u);if(o&&o[q]&&s||i){const e=fo(c,"layout","icon-rotation-alignment",z,m,A);if(2==S){const t=r.getGeometry();if(t.getFlatMidpoint||t.getFlatMidpoints){const r=t.getExtent();if(Math.sqrt(Math.max(Math.pow((r[2]-r[0])/a,2),Math.pow((r[3]-r[1])/a,2)))>150){const r="MultiLineString"===t.getType()?t.getFlatMidpoints():t.getFlatMidpoint();if(co||(po=[NaN,NaN],co=new bn.Ay("Point",po,[],2,{},void 0)),n=co,po[0]=r[0],po[1]=r[1],"line"===fo(c,"layout","symbol-placement",z,m,A)&&"map"===e){const e=t.getStride(),n=t.getFlatCoordinates();for(let t=0,o=n.length-e;t<o;t+=e){const o=n[t],a=n[t+1],i=n[t+e],s=n[t+e+1],l=Math.min(o,i),u=Math.max(o,i),p=r[0],c=(s-a)*(p-o)-(i-o)*(r[1]-a);if(Math.abs(c)<.001&&p<=u&&p>=l){U=Math.atan2(a-s,i-o);break}}}}}}if(2!==S||n){const t=fo(c,"layout","icon-size",z,m,A),r=void 0!==j["icon-color"]?fo(c,"paint","icon-color",z,m,A):null;if(!r||0!==r.a){const n=fo(c,"paint","icon-halo-color",z,m,A),a=fo(c,"paint","icon-halo-width",z,m,A);let l=`${q}.${t}.${a}.${n}`;if(null!==r&&(l+=`.${r}`),C=d[l],!C){const u=yo(c,z,"icon",m);let p;"icon-offset"in $&&(p=fo(c,"layout","icon-offset",z,m,A).slice(0),p[0]*=t,p[1]*=-t);let f=r?[255*r.r,255*r.g,255*r.b,r.a]:void 0;if(i){const r={color:f,rotateWithView:"map"===e,displacement:p,declutterMode:u,scale:t};"string"==typeof i?r.src=i:(r.img=i,r.imgSize=[i.width,i.height]),C=new kn.A(r)}else{const i=o[q];let l,c,d;if(a)i.sdf?(l=Zn(Kn(s.image,i,r||[0,0,0,1]),{x:0,y:0,width:i.width,height:i.height,pixelRatio:i.pixelRatio},a,n),f=void 0):l=Zn(s.image,i,a,n);else{if(i.sdf&&!s.unSDFed){const e=Kn(s.image,{x:0,y:0,width:s.size[0],height:s.size[1]},{r:1,g:1,b:1,a:1});s.image=e,s.unSDFed=!0}l=s.image,c=[i.width,i.height],d=[i.x,i.y]}C=new kn.A({color:f,img:l,imgSize:s.size,size:c,offset:d,rotateWithView:"map"===e,scale:t/i.pixelRatio,displacement:p,declutterMode:u})}d[l]=C}}C&&(++_,k=x[_],k&&k.getImage()&&!k.getFill()&&!k.getStroke()||(k=new $n.Ay,x[_]=k),k.setGeometry(n),C.setRotation(U+Dn(fo(c,"layout","icon-rotate",z,m,A))),C.setOpacity(fo(c,"paint","icon-opacity",z,m,A)),C.setAnchor(lo[fo(c,"layout","icon-anchor",z,m,A)]),k.setImage(C),D=k.getText(),k.setText(void 0),k.setZIndex(E),L=!0,N=!1)}else N=!0}}}if(1==S&&"circle"===c.type){++_,k=x[_],k&&k.getImage()&&!k.getFill()&&!k.getStroke()||(k=new $n.Ay,x[_]=k);const e="circle-radius"in j?fo(c,"paint","circle-radius",z,m,A):5,t=ho(fo(c,"paint","circle-stroke-color",z,m,A),fo(c,"paint","circle-stroke-opacity",z,m,A)),r=fo(c,"paint","circle-translate",z,m,A),n=ho(fo(c,"paint","circle-color",z,m,A),fo(c,"paint","circle-opacity",z,m,A)),o=fo(c,"paint","circle-stroke-width",z,m,A),a=e+"."+t+"."+n+"."+o+"."+r[0]+"."+r[1];C=d[a],C||(C=new xn.A({radius:e,displacement:[r[0],-r[1]],stroke:t&&o>0?new Sn.A({width:o,color:t}):void 0,fill:n?new wn.A({color:n}):void 0,declutterMode:"none"}),d[a]=C),k.setImage(C),D=k.getText(),k.setText(void 0),k.setGeometry(void 0),k.setZIndex(E),L=!0}if("text-field"in $){O=Math.round(fo(c,"layout","text-size",z,m,A));const e=fo(c,"layout","text-font",z,m,A);T=fo(c,"layout","text-line-height",z,m,A),P=yn(s?s(e,t.metadata?t.metadata["ol:webfonts"]:void 0):e,O,T),P.includes("sans-serif")||(P+=",sans-serif"),F=fo(c,"layout","text-letter-spacing",z,m,A),R=fo(c,"layout","text-max-width",z,m,A);const r=fo(c,"layout","text-field",z,m,A);I="object"==typeof r&&r.sections?1===r.sections.length?r.toString():r.sections.reduce(((t,r,n)=>{const o=r.fontStack?r.fontStack.split(","):e,a=yn(s?s(o):o,O*(r.scale||1),T);let i=r.text;if("\n"===i)return t.push("\n",""),t;if(2==S)return t.push(Qn(i,F),a),t;i=oo(i,a,R,F).split("\n");for(let e=0,r=i.length;e<r;++e)e>0&&t.push("\n",""),t.push(i[e],a);return t}),[]):vo(r,f).trim(),i=fo(c,"paint","text-opacity",z,m,A)}if(I&&i&&!N){L||(++_,k=x[_],k&&k.getText()&&!k.getFill()&&!k.getStroke()||(k=new $n.Ay,x[_]=k),k.setImage(void 0),k.setGeometry(void 0));const e=yo(c,z,"text",m);k.getText()||k.setText(D),D=k.getText(),(!D||"getDeclutterMode"in D&&D.getDeclutterMode()!==e)&&(D=new zn.A({padding:[2,2,2,2],declutterMode:e}),k.setText(D));const t=fo(c,"layout","text-transform",z,m,A);"uppercase"==t?I=Array.isArray(I)?I.map(((e,t)=>t%2?e:e.toUpperCase())):I.toUpperCase():"lowercase"==t&&(I=Array.isArray(I)?I.map(((e,t)=>t%2?e:e.toLowerCase())):I.toLowerCase());const r=Array.isArray(I)?I:2==S?Qn(I,F):oo(I,P,R,F);if(D.setText(r),D.setFont(P),D.setRotation(Dn(fo(c,"layout","text-rotate",z,m,A))),"function"==typeof D.setKeepUpright){const e=fo(c,"layout","text-keep-upright",z,m,A);D.setKeepUpright(e)}const n=fo(c,"layout","text-anchor",z,m,A),o=L||1==S?"point":fo(c,"layout","symbol-placement",z,m,A);let a;if("line-center"===o?(D.setPlacement("line"),a="center"):D.setPlacement(o),"line"===o&&"function"==typeof D.setRepeat){const e=fo(c,"layout","symbol-spacing",z,m,A);D.setRepeat(2*e)}D.setOverflow("point"===o);let s=fo(c,"paint","text-halo-width",z,m,A);const l=fo(c,"layout","text-offset",z,m,A),u=fo(c,"paint","text-translate",z,m,A);let p=0,f=0;if("point"==o){a="center",-1!==n.indexOf("left")?(a="left",f=s):-1!==n.indexOf("right")&&(a="right",f=-s);const e=fo(c,"layout","text-rotation-alignment",z,m,A);D.setRotateWithView("map"==e)}else D.setMaxAngle(Dn(fo(c,"layout","text-max-angle",z,m,A))*I.length/r.length),D.setRotateWithView(!1);D.setTextAlign(a);let d="middle";0==n.indexOf("bottom")?(d="bottom",p=-s-.5*(T-1)*O):0==n.indexOf("top")&&(d="top",p=s+.5*(T-1)*O),D.setTextBaseline(d);const y=fo(c,"layout","text-justify",z,m,A);D.setJustify("auto"===y?void 0:y),D.setOffsetX(l[0]*O+f+u[0]),D.setOffsetY(l[1]*O+p+u[1]),b.setColor(ho(fo(c,"paint","text-color",z,m,A),i)),D.setFill(b);const h=ho(fo(c,"paint","text-halo-color",z,m,A),i);if(h&&s>0){v.setColor(h),s*=2;const e=.5*O;v.setWidth(s<=e?s:e),D.setStroke(v)}else D.setStroke(void 0);const g=fo(c,"layout","text-padding",z,m,A),w=D.getPadding();g!==w[0]&&(w[0]=g,w[1]=g,w[2]=g,w[3]=g),k.setZIndex(E)}}}return _>-1?(x.length=_+1,x):void 0};return e.setStyle(w),e.set("mapbox-layers",f),e.set("mapbox-source",g),e.set("mapbox-featurestate",e.get("mapbox-featurestate")||{}),w}(e,t,u,o,m,h,((e,t=l.webfonts)=>function(e,t="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){let r;for(let t=0,n=e.length;t<n;++t){const n=e[t];if(n in io)continue;io[n]=!0;const o=yn(n,16).split(" ");r||(r=[]),r.push([o.slice(3).join(" ").replace(/"/g,""),o[1],o[0]])}return r?((async()=>{await document.fonts.ready;for(let e=0,n=r.length;e<n;++e){const n=r[e],o=n[0];if(ao.includes(o))continue;const a=n[1],i=n[2];if(!(await document.fonts.load(`${i} ${a} 16px "${o}"`)).some((e=>e.family.replace(/^['"]|['"]$/g,"").toLowerCase()===o.toLowerCase()&&e.weight==a&&e.style===i))){const e=t.replace("{font-family}",o.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",o.replace(/ /g,"+")).replace("{fontweight}",a).replace("{-fontstyle}",i.replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",i);if(!document.querySelector('link[href="'+e+'"]')){const t=document.createElement("link");t.href=e,t.rel="stylesheet",document.head.appendChild(t)}}}})(),e):e}(e,t)),l.getImage,i),e.getStyle()?f().then(r).catch(n):n(new Error(`Nothing to show for source [${s}]`))}}if(t.sprite){const e=function(e,t,r){if("string"==typeof e)return[{id:"default",url:Cn(e,t,r)}];for(const n of e)n.url=Cn(n.url,t,r);return e}(t.sprite,l.accessToken,i||location.href);d=window.devicePixelRatio>=1.5?.5:1;const r=.5==d?"@2x":"";Promise.all(e.map((function(e){const t=new URL(e.url);let o=t.origin+t.pathname+r+".json"+t.search;return new Promise((function(e,r){Wn("Sprite",o,l).then(e).catch((function(n){o=t.origin+t.pathname+".json"+t.search,Wn("Sprite",o,l).then(e).catch(r)}))})).then((function(o){let a;if(void 0===o&&n(new Error("No sprites found.")),a=t.origin+t.pathname+r+".png"+t.search,l.transformRequest){const e=l.transformRequest(a,"SpriteImage")||a;(e instanceof Request||e instanceof Promise)&&(a=e)}h[e.id]=a;for(const t in o){const r="default"==e.id?t:`${e.id}:${t}`;m[r]=o[t]}})).catch((function(e){n(new Error(`Sprites cannot be loaded: ${o}: ${e.message}`))}))}))).then(g).catch(n)}else g()})).catch(n)}))}function Fo(e,t,r={}){return Bn(t,r).then((function(t){!function(e,t,r){t.layers.some((function(t){if("background"===t.type){if(e instanceof $o.A)return e.setBackground((function(e){return Ro(t,e,r,{})})),!0;if(e instanceof mn.A||e instanceof So.A)return e.getLayers().insertAt(0,function(e,t,r){const n=document.createElement("div");return n.className="ol-mapbox-style-background",n.style.position="absolute",n.style.width="100%",n.style.height="100%",new $o.A({source:new Eo.A({}),render(o){const a=Ro(e,o.viewState.resolution,t,r);return n.style.backgroundColor=a,n}})}(t,r,{})),!0}}))}(e,t,r)}))}function Ro(e,t,r,n){const o={id:e.id,type:e.type},a=e.layout||{},i=e.paint||{};let s;o.paint=i,uo.zoom=Gn(t,r.resolutions||Un),uo.distanceFromCenter=0;const l=fo(o,"paint","background-color",Tn,n);return void 0!==i["background-opacity"]&&(s=fo(o,"paint","background-opacity",Tn,n)),"none"==a.visibility?void 0:ho(l,s)}var Lo=r(1685),Do=r(6837);class Uo extends Lo.Ay{constructor(e){super(Do.A.ERROR),this.error=e}}class Vo extends Ao.A{constructor(e){const t=!("declutter"in e)||e.declutter,r=new No.A({state:"loading",format:new ko.A({layerName:"mvt:layer"})});super({source:r,background:!1===e.background?null:e.background,declutter:t,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties}),e.accessToken&&(this.accessToken=e.accessToken);const n=[Oo(this,e.styleUrl,e.layers||e.source,{accessToken:this.accessToken})];void 0===this.getBackground()&&n.push(Fo(this,e.styleUrl,{accessToken:this.accessToken})),Promise.all(n).then((()=>{r.setState("ready")})).catch((e=>{this.dispatchEvent(new Uo(e)),this.getSource().setState("error")}))}}}}]);